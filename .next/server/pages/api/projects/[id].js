"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/projects/[id]";
exports.ids = ["pages/api/projects/[id]"];
exports.modules = {

/***/ "mongoose":
/*!***************************!*\
  !*** external "mongoose" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("mongoose");

/***/ }),

/***/ "next-auth/react":
/*!**********************************!*\
  !*** external "next-auth/react" ***!
  \**********************************/
/***/ ((module) => {

module.exports = require("next-auth/react");

/***/ }),

/***/ "(api)/./lib/dbConnect.js":
/*!**************************!*\
  !*** ./lib/dbConnect.js ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongoose */ \"mongoose\");\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongoose__WEBPACK_IMPORTED_MODULE_0__);\n\nconst MONGODB_URI = process.env.MONGODB_URI || \"mongodb://localhost:27017/smm-calendar\";\nif (!MONGODB_URI) {\n    throw new Error(\"Please define the MONGODB_URI environment variable\");\n}\n/**\n * Global is used here to maintain a cached connection across hot reloads\n * in development. This prevents connections growing exponentially\n * during API Route usage.\n */ let cached = global.mongoose;\nif (!cached) {\n    cached = global.mongoose = {\n        conn: null,\n        promise: null\n    };\n}\nasync function dbConnect() {\n    if (cached.conn) {\n        return cached.conn;\n    }\n    if (!cached.promise) {\n        const opts = {\n            bufferCommands: false\n        };\n        cached.promise = mongoose__WEBPACK_IMPORTED_MODULE_0___default().connect(MONGODB_URI, opts).then((mongoose)=>{\n            return mongoose;\n        });\n    }\n    cached.conn = await cached.promise;\n    return cached.conn;\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (dbConnect);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvZGJDb25uZWN0LmpzLmpzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFnQztBQUVoQyxNQUFNQyxXQUFXLEdBQUdDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDRixXQUFXLElBQUksd0NBQXdDO0FBRXZGLElBQUksQ0FBQ0EsV0FBVyxFQUFFO0lBQ2hCLE1BQU0sSUFBSUcsS0FBSyxDQUNiLG9EQUFvRCxDQUNyRCxDQUFDO0FBQ0osQ0FBQztBQUVEOzs7O0NBSUMsR0FDRCxJQUFJQyxNQUFNLEdBQUdDLE1BQU0sQ0FBQ04sUUFBUTtBQUU1QixJQUFJLENBQUNLLE1BQU0sRUFBRTtJQUNYQSxNQUFNLEdBQUdDLE1BQU0sQ0FBQ04sUUFBUSxHQUFHO1FBQUVPLElBQUksRUFBRSxJQUFJO1FBQUVDLE9BQU8sRUFBRSxJQUFJO0tBQUUsQ0FBQztBQUMzRCxDQUFDO0FBRUQsZUFBZUMsU0FBUyxHQUFHO0lBQ3pCLElBQUlKLE1BQU0sQ0FBQ0UsSUFBSSxFQUFFO1FBQ2YsT0FBT0YsTUFBTSxDQUFDRSxJQUFJLENBQUM7SUFDckIsQ0FBQztJQUVELElBQUksQ0FBQ0YsTUFBTSxDQUFDRyxPQUFPLEVBQUU7UUFDbkIsTUFBTUUsSUFBSSxHQUFHO1lBQ1hDLGNBQWMsRUFBRSxLQUFLO1NBQ3RCO1FBRUROLE1BQU0sQ0FBQ0csT0FBTyxHQUFHUix1REFBZ0IsQ0FBQ0MsV0FBVyxFQUFFUyxJQUFJLENBQUMsQ0FBQ0csSUFBSSxDQUFDLENBQUNiLFFBQVEsR0FBSztZQUN0RSxPQUFPQSxRQUFRLENBQUM7UUFDbEIsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDO0lBQ0RLLE1BQU0sQ0FBQ0UsSUFBSSxHQUFHLE1BQU1GLE1BQU0sQ0FBQ0csT0FBTyxDQUFDO0lBQ25DLE9BQU9ILE1BQU0sQ0FBQ0UsSUFBSSxDQUFDO0FBQ3JCLENBQUM7QUFFRCxpRUFBZUUsU0FBUyxFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc21tLWNvbnRlbnQtY2FsZW5kYXIvLi9saWIvZGJDb25uZWN0LmpzPzFkM2IiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG1vbmdvb3NlIGZyb20gJ21vbmdvb3NlJztcblxuY29uc3QgTU9OR09EQl9VUkkgPSBwcm9jZXNzLmVudi5NT05HT0RCX1VSSSB8fCAnbW9uZ29kYjovL2xvY2FsaG9zdDoyNzAxNy9zbW0tY2FsZW5kYXInO1xuXG5pZiAoIU1PTkdPREJfVVJJKSB7XG4gIHRocm93IG5ldyBFcnJvcihcbiAgICAnUGxlYXNlIGRlZmluZSB0aGUgTU9OR09EQl9VUkkgZW52aXJvbm1lbnQgdmFyaWFibGUnXG4gICk7XG59XG5cbi8qKlxuICogR2xvYmFsIGlzIHVzZWQgaGVyZSB0byBtYWludGFpbiBhIGNhY2hlZCBjb25uZWN0aW9uIGFjcm9zcyBob3QgcmVsb2Fkc1xuICogaW4gZGV2ZWxvcG1lbnQuIFRoaXMgcHJldmVudHMgY29ubmVjdGlvbnMgZ3Jvd2luZyBleHBvbmVudGlhbGx5XG4gKiBkdXJpbmcgQVBJIFJvdXRlIHVzYWdlLlxuICovXG5sZXQgY2FjaGVkID0gZ2xvYmFsLm1vbmdvb3NlO1xuXG5pZiAoIWNhY2hlZCkge1xuICBjYWNoZWQgPSBnbG9iYWwubW9uZ29vc2UgPSB7IGNvbm46IG51bGwsIHByb21pc2U6IG51bGwgfTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gZGJDb25uZWN0KCkge1xuICBpZiAoY2FjaGVkLmNvbm4pIHtcbiAgICByZXR1cm4gY2FjaGVkLmNvbm47XG4gIH1cblxuICBpZiAoIWNhY2hlZC5wcm9taXNlKSB7XG4gICAgY29uc3Qgb3B0cyA9IHtcbiAgICAgIGJ1ZmZlckNvbW1hbmRzOiBmYWxzZSxcbiAgICB9O1xuXG4gICAgY2FjaGVkLnByb21pc2UgPSBtb25nb29zZS5jb25uZWN0KE1PTkdPREJfVVJJLCBvcHRzKS50aGVuKChtb25nb29zZSkgPT4ge1xuICAgICAgcmV0dXJuIG1vbmdvb3NlO1xuICAgIH0pO1xuICB9XG4gIGNhY2hlZC5jb25uID0gYXdhaXQgY2FjaGVkLnByb21pc2U7XG4gIHJldHVybiBjYWNoZWQuY29ubjtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZGJDb25uZWN0O1xuIl0sIm5hbWVzIjpbIm1vbmdvb3NlIiwiTU9OR09EQl9VUkkiLCJwcm9jZXNzIiwiZW52IiwiRXJyb3IiLCJjYWNoZWQiLCJnbG9iYWwiLCJjb25uIiwicHJvbWlzZSIsImRiQ29ubmVjdCIsIm9wdHMiLCJidWZmZXJDb21tYW5kcyIsImNvbm5lY3QiLCJ0aGVuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./lib/dbConnect.js\n");

/***/ }),

/***/ "(api)/./models/Project.js":
/*!***************************!*\
  !*** ./models/Project.js ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongoose */ \"mongoose\");\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongoose__WEBPACK_IMPORTED_MODULE_0__);\n\nconst DayContentSchema = new (mongoose__WEBPACK_IMPORTED_MODULE_0___default().Schema)({\n    socialNetwork: {\n        type: String,\n        default: \"\"\n    },\n    images: {\n        type: [\n            String\n        ],\n        default: []\n    },\n    text: {\n        type: String,\n        default: \"\"\n    }\n});\nconst ProjectSchema = new (mongoose__WEBPACK_IMPORTED_MODULE_0___default().Schema)({\n    name: {\n        type: String,\n        required: [\n            true,\n            \"Please provide a project name\"\n        ],\n        trim: true\n    },\n    owner: {\n        type: (mongoose__WEBPACK_IMPORTED_MODULE_0___default().Schema.Types.ObjectId),\n        ref: \"User\",\n        required: true\n    },\n    days: {\n        type: [\n            DayContentSchema\n        ],\n        default: Array(7).fill({\n            socialNetwork: \"\",\n            images: [],\n            text: \"\"\n        })\n    },\n    companyName: {\n        type: String,\n        default: \"\"\n    },\n    companyDescription: {\n        type: String,\n        default: \"\"\n    },\n    companyWebsite: {\n        type: String,\n        default: \"\"\n    },\n    socialLinks: {\n        type: Map,\n        of: String,\n        default: {}\n    },\n    imagePrompt: {\n        type: String,\n        default: \"\"\n    },\n    createdAt: {\n        type: Date,\n        default: Date.now\n    },\n    updatedAt: {\n        type: Date,\n        default: Date.now\n    }\n});\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((mongoose__WEBPACK_IMPORTED_MODULE_0___default().models.Project) || mongoose__WEBPACK_IMPORTED_MODULE_0___default().model(\"Project\", ProjectSchema));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9tb2RlbHMvUHJvamVjdC5qcy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBZ0M7QUFFaEMsTUFBTUMsZ0JBQWdCLEdBQUcsSUFBSUQsd0RBQWUsQ0FBQztJQUMzQ0csYUFBYSxFQUFFO1FBQ2JDLElBQUksRUFBRUMsTUFBTTtRQUNaQyxPQUFPLEVBQUUsRUFBRTtLQUNaO0lBQ0RDLE1BQU0sRUFBRTtRQUNOSCxJQUFJLEVBQUU7WUFBQ0MsTUFBTTtTQUFDO1FBQ2RDLE9BQU8sRUFBRSxFQUFFO0tBQ1o7SUFDREUsSUFBSSxFQUFFO1FBQ0pKLElBQUksRUFBRUMsTUFBTTtRQUNaQyxPQUFPLEVBQUUsRUFBRTtLQUNaO0NBQ0YsQ0FBQztBQUVGLE1BQU1HLGFBQWEsR0FBRyxJQUFJVCx3REFBZSxDQUFDO0lBQ3hDVSxJQUFJLEVBQUU7UUFDSk4sSUFBSSxFQUFFQyxNQUFNO1FBQ1pNLFFBQVEsRUFBRTtZQUFDLElBQUk7WUFBRSwrQkFBK0I7U0FBQztRQUNqREMsSUFBSSxFQUFFLElBQUk7S0FDWDtJQUNEQyxLQUFLLEVBQUU7UUFDTFQsSUFBSSxFQUFFSix1RUFBOEI7UUFDcENnQixHQUFHLEVBQUUsTUFBTTtRQUNYTCxRQUFRLEVBQUUsSUFBSTtLQUNmO0lBQ0RNLElBQUksRUFBRTtRQUNKYixJQUFJLEVBQUU7WUFBQ0gsZ0JBQWdCO1NBQUM7UUFDeEJLLE9BQU8sRUFBRVksS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDQyxJQUFJLENBQUM7WUFDckJoQixhQUFhLEVBQUUsRUFBRTtZQUNqQkksTUFBTSxFQUFFLEVBQUU7WUFDVkMsSUFBSSxFQUFFLEVBQUU7U0FDVCxDQUFDO0tBQ0g7SUFDRFksV0FBVyxFQUFFO1FBQ1hoQixJQUFJLEVBQUVDLE1BQU07UUFDWkMsT0FBTyxFQUFFLEVBQUU7S0FDWjtJQUNEZSxrQkFBa0IsRUFBRTtRQUNsQmpCLElBQUksRUFBRUMsTUFBTTtRQUNaQyxPQUFPLEVBQUUsRUFBRTtLQUNaO0lBQ0RnQixjQUFjLEVBQUU7UUFDZGxCLElBQUksRUFBRUMsTUFBTTtRQUNaQyxPQUFPLEVBQUUsRUFBRTtLQUNaO0lBQ0RpQixXQUFXLEVBQUU7UUFDWG5CLElBQUksRUFBRW9CLEdBQUc7UUFDVEMsRUFBRSxFQUFFcEIsTUFBTTtRQUNWQyxPQUFPLEVBQUUsRUFBRTtLQUNaO0lBQ0RvQixXQUFXLEVBQUU7UUFDWHRCLElBQUksRUFBRUMsTUFBTTtRQUNaQyxPQUFPLEVBQUUsRUFBRTtLQUNaO0lBQ0RxQixTQUFTLEVBQUU7UUFDVHZCLElBQUksRUFBRXdCLElBQUk7UUFDVnRCLE9BQU8sRUFBRXNCLElBQUksQ0FBQ0MsR0FBRztLQUNsQjtJQUNEQyxTQUFTLEVBQUU7UUFDVDFCLElBQUksRUFBRXdCLElBQUk7UUFDVnRCLE9BQU8sRUFBRXNCLElBQUksQ0FBQ0MsR0FBRztLQUNsQjtDQUNGLENBQUM7QUFFRixpRUFBZTdCLGdFQUF1QixJQUFJQSxxREFBYyxDQUFDLFNBQVMsRUFBRVMsYUFBYSxDQUFDLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zbW0tY29udGVudC1jYWxlbmRhci8uL21vZGVscy9Qcm9qZWN0LmpzP2NiMTIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG1vbmdvb3NlIGZyb20gJ21vbmdvb3NlJztcblxuY29uc3QgRGF5Q29udGVudFNjaGVtYSA9IG5ldyBtb25nb29zZS5TY2hlbWEoe1xuICBzb2NpYWxOZXR3b3JrOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIGRlZmF1bHQ6ICcnLFxuICB9LFxuICBpbWFnZXM6IHtcbiAgICB0eXBlOiBbU3RyaW5nXSxcbiAgICBkZWZhdWx0OiBbXSxcbiAgfSxcbiAgdGV4dDoge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICBkZWZhdWx0OiAnJyxcbiAgfSxcbn0pO1xuXG5jb25zdCBQcm9qZWN0U2NoZW1hID0gbmV3IG1vbmdvb3NlLlNjaGVtYSh7XG4gIG5hbWU6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgcmVxdWlyZWQ6IFt0cnVlLCAnUGxlYXNlIHByb3ZpZGUgYSBwcm9qZWN0IG5hbWUnXSxcbiAgICB0cmltOiB0cnVlLFxuICB9LFxuICBvd25lcjoge1xuICAgIHR5cGU6IG1vbmdvb3NlLlNjaGVtYS5UeXBlcy5PYmplY3RJZCxcbiAgICByZWY6ICdVc2VyJyxcbiAgICByZXF1aXJlZDogdHJ1ZSxcbiAgfSxcbiAgZGF5czoge1xuICAgIHR5cGU6IFtEYXlDb250ZW50U2NoZW1hXSxcbiAgICBkZWZhdWx0OiBBcnJheSg3KS5maWxsKHtcbiAgICAgIHNvY2lhbE5ldHdvcms6ICcnLFxuICAgICAgaW1hZ2VzOiBbXSxcbiAgICAgIHRleHQ6ICcnLFxuICAgIH0pLFxuICB9LFxuICBjb21wYW55TmFtZToge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICBkZWZhdWx0OiAnJyxcbiAgfSxcbiAgY29tcGFueURlc2NyaXB0aW9uOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIGRlZmF1bHQ6ICcnLFxuICB9LFxuICBjb21wYW55V2Vic2l0ZToge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICBkZWZhdWx0OiAnJyxcbiAgfSxcbiAgc29jaWFsTGlua3M6IHtcbiAgICB0eXBlOiBNYXAsXG4gICAgb2Y6IFN0cmluZyxcbiAgICBkZWZhdWx0OiB7fSxcbiAgfSxcbiAgaW1hZ2VQcm9tcHQ6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgZGVmYXVsdDogJycsXG4gIH0sXG4gIGNyZWF0ZWRBdDoge1xuICAgIHR5cGU6IERhdGUsXG4gICAgZGVmYXVsdDogRGF0ZS5ub3csXG4gIH0sXG4gIHVwZGF0ZWRBdDoge1xuICAgIHR5cGU6IERhdGUsXG4gICAgZGVmYXVsdDogRGF0ZS5ub3csXG4gIH0sXG59KTtcblxuZXhwb3J0IGRlZmF1bHQgbW9uZ29vc2UubW9kZWxzLlByb2plY3QgfHwgbW9uZ29vc2UubW9kZWwoJ1Byb2plY3QnLCBQcm9qZWN0U2NoZW1hKTtcbiJdLCJuYW1lcyI6WyJtb25nb29zZSIsIkRheUNvbnRlbnRTY2hlbWEiLCJTY2hlbWEiLCJzb2NpYWxOZXR3b3JrIiwidHlwZSIsIlN0cmluZyIsImRlZmF1bHQiLCJpbWFnZXMiLCJ0ZXh0IiwiUHJvamVjdFNjaGVtYSIsIm5hbWUiLCJyZXF1aXJlZCIsInRyaW0iLCJvd25lciIsIlR5cGVzIiwiT2JqZWN0SWQiLCJyZWYiLCJkYXlzIiwiQXJyYXkiLCJmaWxsIiwiY29tcGFueU5hbWUiLCJjb21wYW55RGVzY3JpcHRpb24iLCJjb21wYW55V2Vic2l0ZSIsInNvY2lhbExpbmtzIiwiTWFwIiwib2YiLCJpbWFnZVByb21wdCIsImNyZWF0ZWRBdCIsIkRhdGUiLCJub3ciLCJ1cGRhdGVkQXQiLCJtb2RlbHMiLCJQcm9qZWN0IiwibW9kZWwiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./models/Project.js\n");

/***/ }),

/***/ "(api)/./pages/api/projects/[id].js":
/*!************************************!*\
  !*** ./pages/api/projects/[id].js ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _lib_dbConnect__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/dbConnect */ \"(api)/./lib/dbConnect.js\");\n/* harmony import */ var _models_Project__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../models/Project */ \"(api)/./models/Project.js\");\n/* harmony import */ var next_auth_react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next-auth/react */ \"next-auth/react\");\n/* harmony import */ var next_auth_react__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_auth_react__WEBPACK_IMPORTED_MODULE_2__);\n\n\n\n// In-memory projects storage for test users\nconst TEST_USER_IDS = [\n    \"test-user-123\",\n    \"test-user-222\"\n];\n// This is imported from the index.js file at runtime\n// We're declaring it here for clarity but it will use the same array\nlet testUserProjects = global.testUserProjects || [];\nif (!global.testUserProjects) {\n    global.testUserProjects = testUserProjects;\n}\n// Save function from index.js\nconst saveTestProjects = global.saveTestProjects || (()=>{\n    console.error(\"saveTestProjects function not available\");\n});\nasync function handler(req, res) {\n    const session = await (0,next_auth_react__WEBPACK_IMPORTED_MODULE_2__.getSession)({\n        req\n    });\n    const { id  } = req.query;\n    const demoMode = req.query.demo === \"true\";\n    console.log(\"API request for project:\", id);\n    console.log(\"Session:\", session ? {\n        userId: session.user.id,\n        username: session.user.username\n    } : \"No session\");\n    console.log(\"Demo mode:\", demoMode);\n    // Если режим демонстрации и метод GET, разрешаем доступ без авторизации\n    if (demoMode && req.method === \"GET\") {\n        // Для демо-режима используем тестовые проекты\n        return handleDemoMode(req, res, id);\n    }\n    // Для остальных запросов требуется авторизация\n    if (!session) {\n        console.log(\"Not authenticated, returning 401\");\n        return res.status(401).json({\n            message: \"Not authenticated\"\n        });\n    }\n    // Handle test user separately (no DB connection needed)\n    if (TEST_USER_IDS.includes(session.user.id)) {\n        console.log(\"Handling test user:\", session.user.id);\n        return handleTestUser(req, res, session, id);\n    }\n    // For regular users, use MongoDB\n    try {\n        await (0,_lib_dbConnect__WEBPACK_IMPORTED_MODULE_0__[\"default\"])();\n        switch(req.method){\n            case \"GET\":\n                try {\n                    const project = await _models_Project__WEBPACK_IMPORTED_MODULE_1__[\"default\"].findOne({\n                        _id: id,\n                        owner: session.user.id\n                    });\n                    if (!project) {\n                        return res.status(404).json({\n                            success: false,\n                            message: \"Project not found\"\n                        });\n                    }\n                    res.status(200).json({\n                        success: true,\n                        data: project\n                    });\n                } catch (error) {\n                    res.status(400).json({\n                        success: false,\n                        message: error.message\n                    });\n                }\n                break;\n            case \"PUT\":\n                try {\n                    const project1 = await _models_Project__WEBPACK_IMPORTED_MODULE_1__[\"default\"].findOneAndUpdate({\n                        _id: id,\n                        owner: session.user.id\n                    }, {\n                        ...req.body,\n                        updatedAt: Date.now()\n                    }, {\n                        new: true,\n                        runValidators: true\n                    });\n                    if (!project1) {\n                        return res.status(404).json({\n                            success: false,\n                            message: \"Project not found\"\n                        });\n                    }\n                    res.status(200).json({\n                        success: true,\n                        data: project1\n                    });\n                } catch (error1) {\n                    res.status(400).json({\n                        success: false,\n                        message: error1.message\n                    });\n                }\n                break;\n            case \"DELETE\":\n                try {\n                    const deletedProject = await _models_Project__WEBPACK_IMPORTED_MODULE_1__[\"default\"].findOneAndDelete({\n                        _id: id,\n                        owner: session.user.id\n                    });\n                    if (!deletedProject) {\n                        return res.status(404).json({\n                            success: false,\n                            message: \"Project not found\"\n                        });\n                    }\n                    res.status(200).json({\n                        success: true,\n                        data: {}\n                    });\n                } catch (error2) {\n                    res.status(400).json({\n                        success: false,\n                        message: error2.message\n                    });\n                }\n                break;\n            default:\n                res.status(405).json({\n                    success: false,\n                    message: \"Method not allowed\"\n                });\n                break;\n        }\n    } catch (error3) {\n        console.error(\"Database connection error:\", error3);\n        // Fall back to in-memory storage for all users if DB connection fails\n        return handleTestUser(req, res, session, id);\n    }\n}\n// Handle test user with in-memory storage\nfunction handleTestUser(req, res, session, id) {\n    // Make sure we have the latest projects\n    testUserProjects = global.testUserProjects || [];\n    console.log(`Handling ${req.method} request for project ${id}`);\n    console.log(`Current projects: ${testUserProjects.length}`);\n    console.log(\"Test user projects:\", testUserProjects.map((p)=>({\n            id: p._id,\n            name: p.name,\n            owner: p.owner\n        })));\n    switch(req.method){\n        case \"GET\":\n            // Изменяем логику поиска проекта - ищем проект по ID без проверки владельца\n            const project = testUserProjects.find((p)=>p._id === id);\n            if (!project) {\n                console.log(`Project not found: ${id}`);\n                return res.status(404).json({\n                    success: false,\n                    message: \"Project not found\"\n                });\n            }\n            // Возвращаем копию проекта с владельцем текущего пользователя\n            // Это позволит обоим пользователям редактировать один и тот же проект\n            const projectCopy = {\n                ...JSON.parse(JSON.stringify(project)),\n                owner: session.user.id\n            };\n            console.log(`Project found: ${projectCopy.name}, returning with owner: ${projectCopy.owner}`);\n            res.status(200).json({\n                success: true,\n                data: projectCopy\n            });\n            break;\n        case \"PUT\":\n            const projectIndex = testUserProjects.findIndex((p)=>p._id === id);\n            if (projectIndex === -1) {\n                return res.status(404).json({\n                    success: false,\n                    message: \"Project not found\"\n                });\n            }\n            // Сохраняем текущего владельца проекта\n            const originalOwner = testUserProjects[projectIndex].owner;\n            // Обновляем проект, сохраняя оригинального владельца\n            testUserProjects[projectIndex] = {\n                ...testUserProjects[projectIndex],\n                ...req.body,\n                owner: originalOwner,\n                updatedAt: new Date().toISOString()\n            };\n            console.log(`Project updated: ${testUserProjects[projectIndex].name}, original owner: ${originalOwner}`);\n            // Update global reference and save to file\n            global.testUserProjects = testUserProjects;\n            if (typeof global.saveTestProjects === \"function\") {\n                global.saveTestProjects();\n            }\n            // Возвращаем копию проекта с владельцем текущего пользователя\n            const updatedProjectCopy = {\n                ...JSON.parse(JSON.stringify(testUserProjects[projectIndex])),\n                owner: session.user.id\n            };\n            res.status(200).json({\n                success: true,\n                data: updatedProjectCopy\n            });\n            break;\n        case \"DELETE\":\n            const projectToDelete = testUserProjects.find((p)=>p._id === id);\n            if (!projectToDelete) {\n                return res.status(404).json({\n                    success: false,\n                    message: \"Project not found\"\n                });\n            }\n            testUserProjects = testUserProjects.filter((p)=>p._id !== id);\n            // Update global reference and save to file\n            global.testUserProjects = testUserProjects;\n            if (typeof global.saveTestProjects === \"function\") {\n                global.saveTestProjects();\n            }\n            res.status(200).json({\n                success: true,\n                data: {}\n            });\n            break;\n        default:\n            res.status(405).json({\n                success: false,\n                message: \"Method not allowed\"\n            });\n            break;\n    }\n}\n// Handle demo mode\nfunction handleDemoMode(req, res, id) {\n    // Для режима демонстрации используем все проекты без проверки владельца\n    console.log(\"Demo mode activated for project ID:\", id);\n    console.log(\"Available test projects:\", testUserProjects.length);\n    // Проверяем, существуют ли проекты\n    if (!testUserProjects || testUserProjects.length === 0) {\n        console.log(\"No test projects available\");\n        return res.status(404).json({\n            success: false,\n            message: \"No projects available in demo mode\"\n        });\n    }\n    // Если запрашивается конкретный проект\n    if (id) {\n        // Пытаемся найти проект по ID без проверки владельца\n        let project = testUserProjects.find((p)=>p._id === id);\n        // Если проект не найден по точному совпадению, пробуем найти по частичному совпадению\n        if (!project) {\n            console.log(\"Trying partial match for ID:\", id);\n            project = testUserProjects.find((p)=>p._id && p._id.toString().includes(id));\n        }\n        // Если проект все еще не найден, возвращаем первый проект (для демонстрации)\n        if (!project && testUserProjects.length > 0) {\n            console.log(\"Using first available project for demo\");\n            project = testUserProjects[0];\n        }\n        if (project) {\n            console.log(`Returning project: ${project.name}`);\n            return res.status(200).json({\n                success: true,\n                data: project\n            });\n        }\n    }\n    // Если проект не найден, возвращаем ошибку\n    console.log(\"Project not found in demo mode\");\n    return res.status(404).json({\n        success: false,\n        message: \"Project not found\"\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvcHJvamVjdHMvW2lkXS5qcy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUErQztBQUNEO0FBQ0Q7QUFFN0MsNENBQTRDO0FBQzVDLE1BQU1HLGFBQWEsR0FBRztJQUFDLGVBQWU7SUFBRSxlQUFlO0NBQUM7QUFDeEQscURBQXFEO0FBQ3JELHFFQUFxRTtBQUNyRSxJQUFJQyxnQkFBZ0IsR0FBR0MsTUFBTSxDQUFDRCxnQkFBZ0IsSUFBSSxFQUFFO0FBQ3BELElBQUksQ0FBQ0MsTUFBTSxDQUFDRCxnQkFBZ0IsRUFBRTtJQUM1QkMsTUFBTSxDQUFDRCxnQkFBZ0IsR0FBR0EsZ0JBQWdCLENBQUM7QUFDN0MsQ0FBQztBQUVELDhCQUE4QjtBQUM5QixNQUFNRSxnQkFBZ0IsR0FBR0QsTUFBTSxDQUFDQyxnQkFBZ0IsSUFBSyxLQUFNO0lBQ3pEQyxPQUFPLENBQUNDLEtBQUssQ0FBQyx5Q0FBeUMsQ0FBQyxDQUFDO0FBQzNELENBQUM7QUFFYyxlQUFlQyxPQUFPLENBQUNDLEdBQUcsRUFBRUMsR0FBRyxFQUFFO0lBQzlDLE1BQU1DLE9BQU8sR0FBRyxNQUFNViwyREFBVSxDQUFDO1FBQUVRLEdBQUc7S0FBRSxDQUFDO0lBQ3pDLE1BQU0sRUFBRUcsRUFBRSxHQUFFLEdBQUdILEdBQUcsQ0FBQ0ksS0FBSztJQUN4QixNQUFNQyxRQUFRLEdBQUdMLEdBQUcsQ0FBQ0ksS0FBSyxDQUFDRSxJQUFJLEtBQUssTUFBTTtJQUUxQ1QsT0FBTyxDQUFDVSxHQUFHLENBQUMsMEJBQTBCLEVBQUVKLEVBQUUsQ0FBQyxDQUFDO0lBQzVDTixPQUFPLENBQUNVLEdBQUcsQ0FBQyxVQUFVLEVBQUVMLE9BQU8sR0FBRztRQUFFTSxNQUFNLEVBQUVOLE9BQU8sQ0FBQ08sSUFBSSxDQUFDTixFQUFFO1FBQUVPLFFBQVEsRUFBRVIsT0FBTyxDQUFDTyxJQUFJLENBQUNDLFFBQVE7S0FBRSxHQUFHLFlBQVksQ0FBQyxDQUFDO0lBQy9HYixPQUFPLENBQUNVLEdBQUcsQ0FBQyxZQUFZLEVBQUVGLFFBQVEsQ0FBQyxDQUFDO0lBRXBDLHdFQUF3RTtJQUN4RSxJQUFJQSxRQUFRLElBQUlMLEdBQUcsQ0FBQ1csTUFBTSxLQUFLLEtBQUssRUFBRTtRQUNwQyw4Q0FBOEM7UUFDOUMsT0FBT0MsY0FBYyxDQUFDWixHQUFHLEVBQUVDLEdBQUcsRUFBRUUsRUFBRSxDQUFDLENBQUM7SUFDdEMsQ0FBQztJQUVELCtDQUErQztJQUMvQyxJQUFJLENBQUNELE9BQU8sRUFBRTtRQUNaTCxPQUFPLENBQUNVLEdBQUcsQ0FBQyxrQ0FBa0MsQ0FBQyxDQUFDO1FBQ2hELE9BQU9OLEdBQUcsQ0FBQ1ksTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7WUFBRUMsT0FBTyxFQUFFLG1CQUFtQjtTQUFFLENBQUMsQ0FBQztJQUNoRSxDQUFDO0lBRUQsd0RBQXdEO0lBQ3hELElBQUl0QixhQUFhLENBQUN1QixRQUFRLENBQUNkLE9BQU8sQ0FBQ08sSUFBSSxDQUFDTixFQUFFLENBQUMsRUFBRTtRQUMzQ04sT0FBTyxDQUFDVSxHQUFHLENBQUMscUJBQXFCLEVBQUVMLE9BQU8sQ0FBQ08sSUFBSSxDQUFDTixFQUFFLENBQUMsQ0FBQztRQUNwRCxPQUFPYyxjQUFjLENBQUNqQixHQUFHLEVBQUVDLEdBQUcsRUFBRUMsT0FBTyxFQUFFQyxFQUFFLENBQUMsQ0FBQztJQUMvQyxDQUFDO0lBRUQsaUNBQWlDO0lBQ2pDLElBQUk7UUFDRixNQUFNYiwwREFBUyxFQUFFLENBQUM7UUFFbEIsT0FBUVUsR0FBRyxDQUFDVyxNQUFNO1lBQ2hCLEtBQUssS0FBSztnQkFDUixJQUFJO29CQUNGLE1BQU1PLE9BQU8sR0FBRyxNQUFNM0IsK0RBQWUsQ0FBQzt3QkFDcEM2QixHQUFHLEVBQUVqQixFQUFFO3dCQUNQa0IsS0FBSyxFQUFFbkIsT0FBTyxDQUFDTyxJQUFJLENBQUNOLEVBQUU7cUJBQ3ZCLENBQUM7b0JBRUYsSUFBSSxDQUFDZSxPQUFPLEVBQUU7d0JBQ1osT0FBT2pCLEdBQUcsQ0FBQ1ksTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7NEJBQUVRLE9BQU8sRUFBRSxLQUFLOzRCQUFFUCxPQUFPLEVBQUUsbUJBQW1CO3lCQUFFLENBQUMsQ0FBQztvQkFDaEYsQ0FBQztvQkFFRGQsR0FBRyxDQUFDWSxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQzt3QkFBRVEsT0FBTyxFQUFFLElBQUk7d0JBQUVDLElBQUksRUFBRUwsT0FBTztxQkFBRSxDQUFDLENBQUM7Z0JBQ3pELEVBQUUsT0FBT3BCLEtBQUssRUFBRTtvQkFDZEcsR0FBRyxDQUFDWSxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQzt3QkFBRVEsT0FBTyxFQUFFLEtBQUs7d0JBQUVQLE9BQU8sRUFBRWpCLEtBQUssQ0FBQ2lCLE9BQU87cUJBQUUsQ0FBQyxDQUFDO2dCQUNuRSxDQUFDO2dCQUNELE1BQU07WUFFUixLQUFLLEtBQUs7Z0JBQ1IsSUFBSTtvQkFDRixNQUFNRyxRQUFPLEdBQUcsTUFBTTNCLHdFQUF3QixDQUM1Qzt3QkFBRTZCLEdBQUcsRUFBRWpCLEVBQUU7d0JBQUVrQixLQUFLLEVBQUVuQixPQUFPLENBQUNPLElBQUksQ0FBQ04sRUFBRTtxQkFBRSxFQUNuQzt3QkFBRSxHQUFHSCxHQUFHLENBQUN5QixJQUFJO3dCQUFFQyxTQUFTLEVBQUVDLElBQUksQ0FBQ0MsR0FBRyxFQUFFO3FCQUFFLEVBQ3RDO3dCQUFFQyxHQUFHLEVBQUUsSUFBSTt3QkFBRUMsYUFBYSxFQUFFLElBQUk7cUJBQUUsQ0FDbkM7b0JBRUQsSUFBSSxDQUFDWixRQUFPLEVBQUU7d0JBQ1osT0FBT2pCLEdBQUcsQ0FBQ1ksTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7NEJBQUVRLE9BQU8sRUFBRSxLQUFLOzRCQUFFUCxPQUFPLEVBQUUsbUJBQW1CO3lCQUFFLENBQUMsQ0FBQztvQkFDaEYsQ0FBQztvQkFFRGQsR0FBRyxDQUFDWSxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQzt3QkFBRVEsT0FBTyxFQUFFLElBQUk7d0JBQUVDLElBQUksRUFBRUwsUUFBTztxQkFBRSxDQUFDLENBQUM7Z0JBQ3pELEVBQUUsT0FBT3BCLE1BQUssRUFBRTtvQkFDZEcsR0FBRyxDQUFDWSxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQzt3QkFBRVEsT0FBTyxFQUFFLEtBQUs7d0JBQUVQLE9BQU8sRUFBRWpCLE1BQUssQ0FBQ2lCLE9BQU87cUJBQUUsQ0FBQyxDQUFDO2dCQUNuRSxDQUFDO2dCQUNELE1BQU07WUFFUixLQUFLLFFBQVE7Z0JBQ1gsSUFBSTtvQkFDRixNQUFNZ0IsY0FBYyxHQUFHLE1BQU14Qyx3RUFBd0IsQ0FBQzt3QkFDcEQ2QixHQUFHLEVBQUVqQixFQUFFO3dCQUNQa0IsS0FBSyxFQUFFbkIsT0FBTyxDQUFDTyxJQUFJLENBQUNOLEVBQUU7cUJBQ3ZCLENBQUM7b0JBRUYsSUFBSSxDQUFDNEIsY0FBYyxFQUFFO3dCQUNuQixPQUFPOUIsR0FBRyxDQUFDWSxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQzs0QkFBRVEsT0FBTyxFQUFFLEtBQUs7NEJBQUVQLE9BQU8sRUFBRSxtQkFBbUI7eUJBQUUsQ0FBQyxDQUFDO29CQUNoRixDQUFDO29CQUVEZCxHQUFHLENBQUNZLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDO3dCQUFFUSxPQUFPLEVBQUUsSUFBSTt3QkFBRUMsSUFBSSxFQUFFLEVBQUU7cUJBQUUsQ0FBQyxDQUFDO2dCQUNwRCxFQUFFLE9BQU96QixNQUFLLEVBQUU7b0JBQ2RHLEdBQUcsQ0FBQ1ksTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7d0JBQUVRLE9BQU8sRUFBRSxLQUFLO3dCQUFFUCxPQUFPLEVBQUVqQixNQUFLLENBQUNpQixPQUFPO3FCQUFFLENBQUMsQ0FBQztnQkFDbkUsQ0FBQztnQkFDRCxNQUFNO1lBRVI7Z0JBQ0VkLEdBQUcsQ0FBQ1ksTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7b0JBQUVRLE9BQU8sRUFBRSxLQUFLO29CQUFFUCxPQUFPLEVBQUUsb0JBQW9CO2lCQUFFLENBQUMsQ0FBQztnQkFDeEUsTUFBTTtTQUNUO0lBQ0gsRUFBRSxPQUFPakIsTUFBSyxFQUFFO1FBQ2RELE9BQU8sQ0FBQ0MsS0FBSyxDQUFDLDRCQUE0QixFQUFFQSxNQUFLLENBQUMsQ0FBQztRQUNuRCxzRUFBc0U7UUFDdEUsT0FBT21CLGNBQWMsQ0FBQ2pCLEdBQUcsRUFBRUMsR0FBRyxFQUFFQyxPQUFPLEVBQUVDLEVBQUUsQ0FBQyxDQUFDO0lBQy9DLENBQUM7QUFDSCxDQUFDO0FBRUQsMENBQTBDO0FBQzFDLFNBQVNjLGNBQWMsQ0FBQ2pCLEdBQUcsRUFBRUMsR0FBRyxFQUFFQyxPQUFPLEVBQUVDLEVBQUUsRUFBRTtJQUM3Qyx3Q0FBd0M7SUFDeENULGdCQUFnQixHQUFHQyxNQUFNLENBQUNELGdCQUFnQixJQUFJLEVBQUUsQ0FBQztJQUVqREcsT0FBTyxDQUFDVSxHQUFHLENBQUMsQ0FBQyxTQUFTLEVBQUVQLEdBQUcsQ0FBQ1csTUFBTSxDQUFDLHFCQUFxQixFQUFFUixFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDaEVOLE9BQU8sQ0FBQ1UsR0FBRyxDQUFDLENBQUMsa0JBQWtCLEVBQUViLGdCQUFnQixDQUFDdUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQzVEcEMsT0FBTyxDQUFDVSxHQUFHLENBQUMscUJBQXFCLEVBQUViLGdCQUFnQixDQUFDd0MsR0FBRyxDQUFDQyxDQUFBQSxDQUFDLEdBQUs7WUFBRWhDLEVBQUUsRUFBRWdDLENBQUMsQ0FBQ2YsR0FBRztZQUFFZ0IsSUFBSSxFQUFFRCxDQUFDLENBQUNDLElBQUk7WUFBRWYsS0FBSyxFQUFFYyxDQUFDLENBQUNkLEtBQUs7U0FBRSxFQUFFLENBQUMsQ0FBQztJQUU3RyxPQUFRckIsR0FBRyxDQUFDVyxNQUFNO1FBQ2hCLEtBQUssS0FBSztZQUNSLDRFQUE0RTtZQUM1RSxNQUFNTyxPQUFPLEdBQUd4QixnQkFBZ0IsQ0FBQzJDLElBQUksQ0FBQ0YsQ0FBQUEsQ0FBQyxHQUFJQSxDQUFDLENBQUNmLEdBQUcsS0FBS2pCLEVBQUUsQ0FBQztZQUV4RCxJQUFJLENBQUNlLE9BQU8sRUFBRTtnQkFDWnJCLE9BQU8sQ0FBQ1UsR0FBRyxDQUFDLENBQUMsbUJBQW1CLEVBQUVKLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFDeEMsT0FBT0YsR0FBRyxDQUFDWSxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQztvQkFBRVEsT0FBTyxFQUFFLEtBQUs7b0JBQUVQLE9BQU8sRUFBRSxtQkFBbUI7aUJBQUUsQ0FBQyxDQUFDO1lBQ2hGLENBQUM7WUFFRCw4REFBOEQ7WUFDOUQsc0VBQXNFO1lBQ3RFLE1BQU11QixXQUFXLEdBQUc7Z0JBQ2xCLEdBQUdDLElBQUksQ0FBQ0MsS0FBSyxDQUFDRCxJQUFJLENBQUNFLFNBQVMsQ0FBQ3ZCLE9BQU8sQ0FBQyxDQUFDO2dCQUN0Q0csS0FBSyxFQUFFbkIsT0FBTyxDQUFDTyxJQUFJLENBQUNOLEVBQUU7YUFDdkI7WUFFRE4sT0FBTyxDQUFDVSxHQUFHLENBQUMsQ0FBQyxlQUFlLEVBQUUrQixXQUFXLENBQUNGLElBQUksQ0FBQyx3QkFBd0IsRUFBRUUsV0FBVyxDQUFDakIsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQzlGcEIsR0FBRyxDQUFDWSxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQztnQkFBRVEsT0FBTyxFQUFFLElBQUk7Z0JBQUVDLElBQUksRUFBRWUsV0FBVzthQUFFLENBQUMsQ0FBQztZQUMzRCxNQUFNO1FBRVIsS0FBSyxLQUFLO1lBQ1IsTUFBTUksWUFBWSxHQUFHaEQsZ0JBQWdCLENBQUNpRCxTQUFTLENBQUNSLENBQUFBLENBQUMsR0FBSUEsQ0FBQyxDQUFDZixHQUFHLEtBQUtqQixFQUFFLENBQUM7WUFFbEUsSUFBSXVDLFlBQVksS0FBSyxDQUFDLENBQUMsRUFBRTtnQkFDdkIsT0FBT3pDLEdBQUcsQ0FBQ1ksTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7b0JBQUVRLE9BQU8sRUFBRSxLQUFLO29CQUFFUCxPQUFPLEVBQUUsbUJBQW1CO2lCQUFFLENBQUMsQ0FBQztZQUNoRixDQUFDO1lBRUQsdUNBQXVDO1lBQ3ZDLE1BQU02QixhQUFhLEdBQUdsRCxnQkFBZ0IsQ0FBQ2dELFlBQVksQ0FBQyxDQUFDckIsS0FBSztZQUUxRCxxREFBcUQ7WUFDckQzQixnQkFBZ0IsQ0FBQ2dELFlBQVksQ0FBQyxHQUFHO2dCQUMvQixHQUFHaEQsZ0JBQWdCLENBQUNnRCxZQUFZLENBQUM7Z0JBQ2pDLEdBQUcxQyxHQUFHLENBQUN5QixJQUFJO2dCQUNYSixLQUFLLEVBQUV1QixhQUFhO2dCQUNwQmxCLFNBQVMsRUFBRSxJQUFJQyxJQUFJLEVBQUUsQ0FBQ2tCLFdBQVcsRUFBRTthQUNwQyxDQUFDO1lBRUZoRCxPQUFPLENBQUNVLEdBQUcsQ0FBQyxDQUFDLGlCQUFpQixFQUFFYixnQkFBZ0IsQ0FBQ2dELFlBQVksQ0FBQyxDQUFDTixJQUFJLENBQUMsa0JBQWtCLEVBQUVRLGFBQWEsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUV6RywyQ0FBMkM7WUFDM0NqRCxNQUFNLENBQUNELGdCQUFnQixHQUFHQSxnQkFBZ0IsQ0FBQztZQUMzQyxJQUFJLE9BQU9DLE1BQU0sQ0FBQ0MsZ0JBQWdCLEtBQUssVUFBVSxFQUFFO2dCQUNqREQsTUFBTSxDQUFDQyxnQkFBZ0IsRUFBRSxDQUFDO1lBQzVCLENBQUM7WUFFRCw4REFBOEQ7WUFDOUQsTUFBTWtELGtCQUFrQixHQUFHO2dCQUN6QixHQUFHUCxJQUFJLENBQUNDLEtBQUssQ0FBQ0QsSUFBSSxDQUFDRSxTQUFTLENBQUMvQyxnQkFBZ0IsQ0FBQ2dELFlBQVksQ0FBQyxDQUFDLENBQUM7Z0JBQzdEckIsS0FBSyxFQUFFbkIsT0FBTyxDQUFDTyxJQUFJLENBQUNOLEVBQUU7YUFDdkI7WUFFREYsR0FBRyxDQUFDWSxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQztnQkFBRVEsT0FBTyxFQUFFLElBQUk7Z0JBQUVDLElBQUksRUFBRXVCLGtCQUFrQjthQUFFLENBQUMsQ0FBQztZQUNsRSxNQUFNO1FBRVIsS0FBSyxRQUFRO1lBQ1gsTUFBTUMsZUFBZSxHQUFHckQsZ0JBQWdCLENBQUMyQyxJQUFJLENBQUNGLENBQUFBLENBQUMsR0FBSUEsQ0FBQyxDQUFDZixHQUFHLEtBQUtqQixFQUFFLENBQUM7WUFFaEUsSUFBSSxDQUFDNEMsZUFBZSxFQUFFO2dCQUNwQixPQUFPOUMsR0FBRyxDQUFDWSxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQztvQkFBRVEsT0FBTyxFQUFFLEtBQUs7b0JBQUVQLE9BQU8sRUFBRSxtQkFBbUI7aUJBQUUsQ0FBQyxDQUFDO1lBQ2hGLENBQUM7WUFFRHJCLGdCQUFnQixHQUFHQSxnQkFBZ0IsQ0FBQ3NELE1BQU0sQ0FBQ2IsQ0FBQUEsQ0FBQyxHQUFJQSxDQUFDLENBQUNmLEdBQUcsS0FBS2pCLEVBQUUsQ0FBQyxDQUFDO1lBRTlELDJDQUEyQztZQUMzQ1IsTUFBTSxDQUFDRCxnQkFBZ0IsR0FBR0EsZ0JBQWdCLENBQUM7WUFDM0MsSUFBSSxPQUFPQyxNQUFNLENBQUNDLGdCQUFnQixLQUFLLFVBQVUsRUFBRTtnQkFDakRELE1BQU0sQ0FBQ0MsZ0JBQWdCLEVBQUUsQ0FBQztZQUM1QixDQUFDO1lBRURLLEdBQUcsQ0FBQ1ksTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7Z0JBQUVRLE9BQU8sRUFBRSxJQUFJO2dCQUFFQyxJQUFJLEVBQUUsRUFBRTthQUFFLENBQUMsQ0FBQztZQUNsRCxNQUFNO1FBRVI7WUFDRXRCLEdBQUcsQ0FBQ1ksTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7Z0JBQUVRLE9BQU8sRUFBRSxLQUFLO2dCQUFFUCxPQUFPLEVBQUUsb0JBQW9CO2FBQUUsQ0FBQyxDQUFDO1lBQ3hFLE1BQU07S0FDVDtBQUNILENBQUM7QUFFRCxtQkFBbUI7QUFDbkIsU0FBU0gsY0FBYyxDQUFDWixHQUFHLEVBQUVDLEdBQUcsRUFBRUUsRUFBRSxFQUFFO0lBQ3BDLHdFQUF3RTtJQUN4RU4sT0FBTyxDQUFDVSxHQUFHLENBQUMscUNBQXFDLEVBQUVKLEVBQUUsQ0FBQyxDQUFDO0lBQ3ZETixPQUFPLENBQUNVLEdBQUcsQ0FBQywwQkFBMEIsRUFBRWIsZ0JBQWdCLENBQUN1QyxNQUFNLENBQUMsQ0FBQztJQUVqRSxtQ0FBbUM7SUFDbkMsSUFBSSxDQUFDdkMsZ0JBQWdCLElBQUlBLGdCQUFnQixDQUFDdUMsTUFBTSxLQUFLLENBQUMsRUFBRTtRQUN0RHBDLE9BQU8sQ0FBQ1UsR0FBRyxDQUFDLDRCQUE0QixDQUFDLENBQUM7UUFDMUMsT0FBT04sR0FBRyxDQUFDWSxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQztZQUMxQlEsT0FBTyxFQUFFLEtBQUs7WUFDZFAsT0FBTyxFQUFFLG9DQUFvQztTQUM5QyxDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQsdUNBQXVDO0lBQ3ZDLElBQUlaLEVBQUUsRUFBRTtRQUNOLHFEQUFxRDtRQUNyRCxJQUFJZSxPQUFPLEdBQUd4QixnQkFBZ0IsQ0FBQzJDLElBQUksQ0FBQ0YsQ0FBQUEsQ0FBQyxHQUFJQSxDQUFDLENBQUNmLEdBQUcsS0FBS2pCLEVBQUUsQ0FBQztRQUV0RCxzRkFBc0Y7UUFDdEYsSUFBSSxDQUFDZSxPQUFPLEVBQUU7WUFDWnJCLE9BQU8sQ0FBQ1UsR0FBRyxDQUFDLDhCQUE4QixFQUFFSixFQUFFLENBQUMsQ0FBQztZQUNoRGUsT0FBTyxHQUFHeEIsZ0JBQWdCLENBQUMyQyxJQUFJLENBQUNGLENBQUFBLENBQUMsR0FBSUEsQ0FBQyxDQUFDZixHQUFHLElBQUllLENBQUMsQ0FBQ2YsR0FBRyxDQUFDNkIsUUFBUSxFQUFFLENBQUNqQyxRQUFRLENBQUNiLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFDL0UsQ0FBQztRQUVELDZFQUE2RTtRQUM3RSxJQUFJLENBQUNlLE9BQU8sSUFBSXhCLGdCQUFnQixDQUFDdUMsTUFBTSxHQUFHLENBQUMsRUFBRTtZQUMzQ3BDLE9BQU8sQ0FBQ1UsR0FBRyxDQUFDLHdDQUF3QyxDQUFDLENBQUM7WUFDdERXLE9BQU8sR0FBR3hCLGdCQUFnQixDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ2hDLENBQUM7UUFFRCxJQUFJd0IsT0FBTyxFQUFFO1lBQ1hyQixPQUFPLENBQUNVLEdBQUcsQ0FBQyxDQUFDLG1CQUFtQixFQUFFVyxPQUFPLENBQUNrQixJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDbEQsT0FBT25DLEdBQUcsQ0FBQ1ksTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7Z0JBQUVRLE9BQU8sRUFBRSxJQUFJO2dCQUFFQyxJQUFJLEVBQUVMLE9BQU87YUFBRSxDQUFDLENBQUM7UUFDaEUsQ0FBQztJQUNILENBQUM7SUFFRCwyQ0FBMkM7SUFDM0NyQixPQUFPLENBQUNVLEdBQUcsQ0FBQyxnQ0FBZ0MsQ0FBQyxDQUFDO0lBQzlDLE9BQU9OLEdBQUcsQ0FBQ1ksTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7UUFBRVEsT0FBTyxFQUFFLEtBQUs7UUFBRVAsT0FBTyxFQUFFLG1CQUFtQjtLQUFFLENBQUMsQ0FBQztBQUNoRixDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc21tLWNvbnRlbnQtY2FsZW5kYXIvLi9wYWdlcy9hcGkvcHJvamVjdHMvW2lkXS5qcz9kOTk2Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBkYkNvbm5lY3QgZnJvbSAnLi4vLi4vLi4vbGliL2RiQ29ubmVjdCc7XG5pbXBvcnQgUHJvamVjdCBmcm9tICcuLi8uLi8uLi9tb2RlbHMvUHJvamVjdCc7XG5pbXBvcnQgeyBnZXRTZXNzaW9uIH0gZnJvbSAnbmV4dC1hdXRoL3JlYWN0JztcblxuLy8gSW4tbWVtb3J5IHByb2plY3RzIHN0b3JhZ2UgZm9yIHRlc3QgdXNlcnNcbmNvbnN0IFRFU1RfVVNFUl9JRFMgPSBbJ3Rlc3QtdXNlci0xMjMnLCAndGVzdC11c2VyLTIyMiddO1xuLy8gVGhpcyBpcyBpbXBvcnRlZCBmcm9tIHRoZSBpbmRleC5qcyBmaWxlIGF0IHJ1bnRpbWVcbi8vIFdlJ3JlIGRlY2xhcmluZyBpdCBoZXJlIGZvciBjbGFyaXR5IGJ1dCBpdCB3aWxsIHVzZSB0aGUgc2FtZSBhcnJheVxubGV0IHRlc3RVc2VyUHJvamVjdHMgPSBnbG9iYWwudGVzdFVzZXJQcm9qZWN0cyB8fCBbXTtcbmlmICghZ2xvYmFsLnRlc3RVc2VyUHJvamVjdHMpIHtcbiAgZ2xvYmFsLnRlc3RVc2VyUHJvamVjdHMgPSB0ZXN0VXNlclByb2plY3RzO1xufVxuXG4vLyBTYXZlIGZ1bmN0aW9uIGZyb20gaW5kZXguanNcbmNvbnN0IHNhdmVUZXN0UHJvamVjdHMgPSBnbG9iYWwuc2F2ZVRlc3RQcm9qZWN0cyB8fCAoKCkgPT4ge1xuICBjb25zb2xlLmVycm9yKCdzYXZlVGVzdFByb2plY3RzIGZ1bmN0aW9uIG5vdCBhdmFpbGFibGUnKTtcbn0pO1xuXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKHJlcSwgcmVzKSB7XG4gIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBnZXRTZXNzaW9uKHsgcmVxIH0pO1xuICBjb25zdCB7IGlkIH0gPSByZXEucXVlcnk7XG4gIGNvbnN0IGRlbW9Nb2RlID0gcmVxLnF1ZXJ5LmRlbW8gPT09ICd0cnVlJztcbiAgXG4gIGNvbnNvbGUubG9nKCdBUEkgcmVxdWVzdCBmb3IgcHJvamVjdDonLCBpZCk7XG4gIGNvbnNvbGUubG9nKCdTZXNzaW9uOicsIHNlc3Npb24gPyB7IHVzZXJJZDogc2Vzc2lvbi51c2VyLmlkLCB1c2VybmFtZTogc2Vzc2lvbi51c2VyLnVzZXJuYW1lIH0gOiAnTm8gc2Vzc2lvbicpO1xuICBjb25zb2xlLmxvZygnRGVtbyBtb2RlOicsIGRlbW9Nb2RlKTtcbiAgXG4gIC8vINCV0YHQu9C4INGA0LXQttC40Lwg0LTQtdC80L7QvdGB0YLRgNCw0YbQuNC4INC4INC80LXRgtC+0LQgR0VULCDRgNCw0LfRgNC10YjQsNC10Lwg0LTQvtGB0YLRg9C/INCx0LXQtyDQsNCy0YLQvtGA0LjQt9Cw0YbQuNC4XG4gIGlmIChkZW1vTW9kZSAmJiByZXEubWV0aG9kID09PSAnR0VUJykge1xuICAgIC8vINCU0LvRjyDQtNC10LzQvi3RgNC10LbQuNC80LAg0LjRgdC/0L7Qu9GM0LfRg9C10Lwg0YLQtdGB0YLQvtCy0YvQtSDQv9GA0L7QtdC60YLRi1xuICAgIHJldHVybiBoYW5kbGVEZW1vTW9kZShyZXEsIHJlcywgaWQpO1xuICB9XG4gIFxuICAvLyDQlNC70Y8g0L7RgdGC0LDQu9GM0L3Ri9GFINC30LDQv9GA0L7RgdC+0LIg0YLRgNC10LHRg9C10YLRgdGPINCw0LLRgtC+0YDQuNC30LDRhtC40Y9cbiAgaWYgKCFzZXNzaW9uKSB7XG4gICAgY29uc29sZS5sb2coJ05vdCBhdXRoZW50aWNhdGVkLCByZXR1cm5pbmcgNDAxJyk7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHsgbWVzc2FnZTogJ05vdCBhdXRoZW50aWNhdGVkJyB9KTtcbiAgfVxuICBcbiAgLy8gSGFuZGxlIHRlc3QgdXNlciBzZXBhcmF0ZWx5IChubyBEQiBjb25uZWN0aW9uIG5lZWRlZClcbiAgaWYgKFRFU1RfVVNFUl9JRFMuaW5jbHVkZXMoc2Vzc2lvbi51c2VyLmlkKSkge1xuICAgIGNvbnNvbGUubG9nKCdIYW5kbGluZyB0ZXN0IHVzZXI6Jywgc2Vzc2lvbi51c2VyLmlkKTtcbiAgICByZXR1cm4gaGFuZGxlVGVzdFVzZXIocmVxLCByZXMsIHNlc3Npb24sIGlkKTtcbiAgfVxuICBcbiAgLy8gRm9yIHJlZ3VsYXIgdXNlcnMsIHVzZSBNb25nb0RCXG4gIHRyeSB7XG4gICAgYXdhaXQgZGJDb25uZWN0KCk7XG5cbiAgICBzd2l0Y2ggKHJlcS5tZXRob2QpIHtcbiAgICAgIGNhc2UgJ0dFVCc6XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgcHJvamVjdCA9IGF3YWl0IFByb2plY3QuZmluZE9uZSh7IFxuICAgICAgICAgICAgX2lkOiBpZCxcbiAgICAgICAgICAgIG93bmVyOiBzZXNzaW9uLnVzZXIuaWRcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBcbiAgICAgICAgICBpZiAoIXByb2plY3QpIHtcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7IHN1Y2Nlc3M6IGZhbHNlLCBtZXNzYWdlOiAnUHJvamVjdCBub3QgZm91bmQnIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBcbiAgICAgICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHByb2plY3QgfSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgcmVzLnN0YXR1cyg0MDApLmpzb24oeyBzdWNjZXNzOiBmYWxzZSwgbWVzc2FnZTogZXJyb3IubWVzc2FnZSB9KTtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICAgICAgXG4gICAgICBjYXNlICdQVVQnOlxuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IHByb2plY3QgPSBhd2FpdCBQcm9qZWN0LmZpbmRPbmVBbmRVcGRhdGUoXG4gICAgICAgICAgICB7IF9pZDogaWQsIG93bmVyOiBzZXNzaW9uLnVzZXIuaWQgfSxcbiAgICAgICAgICAgIHsgLi4ucmVxLmJvZHksIHVwZGF0ZWRBdDogRGF0ZS5ub3coKSB9LFxuICAgICAgICAgICAgeyBuZXc6IHRydWUsIHJ1blZhbGlkYXRvcnM6IHRydWUgfVxuICAgICAgICAgICk7XG4gICAgICAgICAgXG4gICAgICAgICAgaWYgKCFwcm9qZWN0KSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBzdWNjZXNzOiBmYWxzZSwgbWVzc2FnZTogJ1Byb2plY3Qgbm90IGZvdW5kJyB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgXG4gICAgICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBwcm9qZWN0IH0pO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgc3VjY2VzczogZmFsc2UsIG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2UgfSk7XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgICAgIFxuICAgICAgY2FzZSAnREVMRVRFJzpcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBkZWxldGVkUHJvamVjdCA9IGF3YWl0IFByb2plY3QuZmluZE9uZUFuZERlbGV0ZSh7IFxuICAgICAgICAgICAgX2lkOiBpZCxcbiAgICAgICAgICAgIG93bmVyOiBzZXNzaW9uLnVzZXIuaWRcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBcbiAgICAgICAgICBpZiAoIWRlbGV0ZWRQcm9qZWN0KSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBzdWNjZXNzOiBmYWxzZSwgbWVzc2FnZTogJ1Byb2plY3Qgbm90IGZvdW5kJyB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgXG4gICAgICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyBzdWNjZXNzOiB0cnVlLCBkYXRhOiB7fSB9KTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICByZXMuc3RhdHVzKDQwMCkuanNvbih7IHN1Y2Nlc3M6IGZhbHNlLCBtZXNzYWdlOiBlcnJvci5tZXNzYWdlIH0pO1xuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuICAgICAgICBcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJlcy5zdGF0dXMoNDA1KS5qc29uKHsgc3VjY2VzczogZmFsc2UsIG1lc3NhZ2U6ICdNZXRob2Qgbm90IGFsbG93ZWQnIH0pO1xuICAgICAgICBicmVhaztcbiAgICB9XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRGF0YWJhc2UgY29ubmVjdGlvbiBlcnJvcjonLCBlcnJvcik7XG4gICAgLy8gRmFsbCBiYWNrIHRvIGluLW1lbW9yeSBzdG9yYWdlIGZvciBhbGwgdXNlcnMgaWYgREIgY29ubmVjdGlvbiBmYWlsc1xuICAgIHJldHVybiBoYW5kbGVUZXN0VXNlcihyZXEsIHJlcywgc2Vzc2lvbiwgaWQpO1xuICB9XG59XG5cbi8vIEhhbmRsZSB0ZXN0IHVzZXIgd2l0aCBpbi1tZW1vcnkgc3RvcmFnZVxuZnVuY3Rpb24gaGFuZGxlVGVzdFVzZXIocmVxLCByZXMsIHNlc3Npb24sIGlkKSB7XG4gIC8vIE1ha2Ugc3VyZSB3ZSBoYXZlIHRoZSBsYXRlc3QgcHJvamVjdHNcbiAgdGVzdFVzZXJQcm9qZWN0cyA9IGdsb2JhbC50ZXN0VXNlclByb2plY3RzIHx8IFtdO1xuICBcbiAgY29uc29sZS5sb2coYEhhbmRsaW5nICR7cmVxLm1ldGhvZH0gcmVxdWVzdCBmb3IgcHJvamVjdCAke2lkfWApO1xuICBjb25zb2xlLmxvZyhgQ3VycmVudCBwcm9qZWN0czogJHt0ZXN0VXNlclByb2plY3RzLmxlbmd0aH1gKTtcbiAgY29uc29sZS5sb2coJ1Rlc3QgdXNlciBwcm9qZWN0czonLCB0ZXN0VXNlclByb2plY3RzLm1hcChwID0+ICh7IGlkOiBwLl9pZCwgbmFtZTogcC5uYW1lLCBvd25lcjogcC5vd25lciB9KSkpO1xuICBcbiAgc3dpdGNoIChyZXEubWV0aG9kKSB7XG4gICAgY2FzZSAnR0VUJzpcbiAgICAgIC8vINCY0LfQvNC10L3Rj9C10Lwg0LvQvtCz0LjQutGDINC/0L7QuNGB0LrQsCDQv9GA0L7QtdC60YLQsCAtINC40YnQtdC8INC/0YDQvtC10LrRgiDQv9C+IElEINCx0LXQtyDQv9GA0L7QstC10YDQutC4INCy0LvQsNC00LXQu9GM0YbQsFxuICAgICAgY29uc3QgcHJvamVjdCA9IHRlc3RVc2VyUHJvamVjdHMuZmluZChwID0+IHAuX2lkID09PSBpZCk7XG4gICAgICBcbiAgICAgIGlmICghcHJvamVjdCkge1xuICAgICAgICBjb25zb2xlLmxvZyhgUHJvamVjdCBub3QgZm91bmQ6ICR7aWR9YCk7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7IHN1Y2Nlc3M6IGZhbHNlLCBtZXNzYWdlOiAnUHJvamVjdCBub3QgZm91bmQnIH0pO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyDQktC+0LfQstGA0LDRidCw0LXQvCDQutC+0L/QuNGOINC/0YDQvtC10LrRgtCwINGBINCy0LvQsNC00LXQu9GM0YbQtdC8INGC0LXQutGD0YnQtdCz0L4g0L/QvtC70YzQt9C+0LLQsNGC0LXQu9GPXG4gICAgICAvLyDQrdGC0L4g0L/QvtC30LLQvtC70LjRgiDQvtCx0L7QuNC8INC/0L7Qu9GM0LfQvtCy0LDRgtC10LvRj9C8INGA0LXQtNCw0LrRgtC40YDQvtCy0LDRgtGMINC+0LTQuNC9INC4INGC0L7RgiDQttC1INC/0YDQvtC10LrRglxuICAgICAgY29uc3QgcHJvamVjdENvcHkgPSB7XG4gICAgICAgIC4uLkpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkocHJvamVjdCkpLFxuICAgICAgICBvd25lcjogc2Vzc2lvbi51c2VyLmlkXG4gICAgICB9O1xuICAgICAgXG4gICAgICBjb25zb2xlLmxvZyhgUHJvamVjdCBmb3VuZDogJHtwcm9qZWN0Q29weS5uYW1lfSwgcmV0dXJuaW5nIHdpdGggb3duZXI6ICR7cHJvamVjdENvcHkub3duZXJ9YCk7XG4gICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHByb2plY3RDb3B5IH0pO1xuICAgICAgYnJlYWs7XG4gICAgICBcbiAgICBjYXNlICdQVVQnOlxuICAgICAgY29uc3QgcHJvamVjdEluZGV4ID0gdGVzdFVzZXJQcm9qZWN0cy5maW5kSW5kZXgocCA9PiBwLl9pZCA9PT0gaWQpO1xuICAgICAgXG4gICAgICBpZiAocHJvamVjdEluZGV4ID09PSAtMSkge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBzdWNjZXNzOiBmYWxzZSwgbWVzc2FnZTogJ1Byb2plY3Qgbm90IGZvdW5kJyB9KTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8g0KHQvtGF0YDQsNC90Y/QtdC8INGC0LXQutGD0YnQtdCz0L4g0LLQu9Cw0LTQtdC70YzRhtCwINC/0YDQvtC10LrRgtCwXG4gICAgICBjb25zdCBvcmlnaW5hbE93bmVyID0gdGVzdFVzZXJQcm9qZWN0c1twcm9qZWN0SW5kZXhdLm93bmVyO1xuICAgICAgXG4gICAgICAvLyDQntCx0L3QvtCy0LvRj9C10Lwg0L/RgNC+0LXQutGCLCDRgdC+0YXRgNCw0L3Rj9GPINC+0YDQuNCz0LjQvdCw0LvRjNC90L7Qs9C+INCy0LvQsNC00LXQu9GM0YbQsFxuICAgICAgdGVzdFVzZXJQcm9qZWN0c1twcm9qZWN0SW5kZXhdID0ge1xuICAgICAgICAuLi50ZXN0VXNlclByb2plY3RzW3Byb2plY3RJbmRleF0sXG4gICAgICAgIC4uLnJlcS5ib2R5LFxuICAgICAgICBvd25lcjogb3JpZ2luYWxPd25lciwgLy8g0KHQvtGF0YDQsNC90Y/QtdC8INC+0YDQuNCz0LjQvdCw0LvRjNC90L7Qs9C+INCy0LvQsNC00LXQu9GM0YbQsFxuICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgfTtcbiAgICAgIFxuICAgICAgY29uc29sZS5sb2coYFByb2plY3QgdXBkYXRlZDogJHt0ZXN0VXNlclByb2plY3RzW3Byb2plY3RJbmRleF0ubmFtZX0sIG9yaWdpbmFsIG93bmVyOiAke29yaWdpbmFsT3duZXJ9YCk7XG4gICAgICBcbiAgICAgIC8vIFVwZGF0ZSBnbG9iYWwgcmVmZXJlbmNlIGFuZCBzYXZlIHRvIGZpbGVcbiAgICAgIGdsb2JhbC50ZXN0VXNlclByb2plY3RzID0gdGVzdFVzZXJQcm9qZWN0cztcbiAgICAgIGlmICh0eXBlb2YgZ2xvYmFsLnNhdmVUZXN0UHJvamVjdHMgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgZ2xvYmFsLnNhdmVUZXN0UHJvamVjdHMoKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8g0JLQvtC30LLRgNCw0YnQsNC10Lwg0LrQvtC/0LjRjiDQv9GA0L7QtdC60YLQsCDRgSDQstC70LDQtNC10LvRjNGG0LXQvCDRgtC10LrRg9GJ0LXQs9C+INC/0L7Qu9GM0LfQvtCy0LDRgtC10LvRj1xuICAgICAgY29uc3QgdXBkYXRlZFByb2plY3RDb3B5ID0ge1xuICAgICAgICAuLi5KU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRlc3RVc2VyUHJvamVjdHNbcHJvamVjdEluZGV4XSkpLFxuICAgICAgICBvd25lcjogc2Vzc2lvbi51c2VyLmlkXG4gICAgICB9O1xuICAgICAgXG4gICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHVwZGF0ZWRQcm9qZWN0Q29weSB9KTtcbiAgICAgIGJyZWFrO1xuICAgICAgXG4gICAgY2FzZSAnREVMRVRFJzpcbiAgICAgIGNvbnN0IHByb2plY3RUb0RlbGV0ZSA9IHRlc3RVc2VyUHJvamVjdHMuZmluZChwID0+IHAuX2lkID09PSBpZCk7XG4gICAgICBcbiAgICAgIGlmICghcHJvamVjdFRvRGVsZXRlKSB7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7IHN1Y2Nlc3M6IGZhbHNlLCBtZXNzYWdlOiAnUHJvamVjdCBub3QgZm91bmQnIH0pO1xuICAgICAgfVxuICAgICAgXG4gICAgICB0ZXN0VXNlclByb2plY3RzID0gdGVzdFVzZXJQcm9qZWN0cy5maWx0ZXIocCA9PiBwLl9pZCAhPT0gaWQpO1xuICAgICAgXG4gICAgICAvLyBVcGRhdGUgZ2xvYmFsIHJlZmVyZW5jZSBhbmQgc2F2ZSB0byBmaWxlXG4gICAgICBnbG9iYWwudGVzdFVzZXJQcm9qZWN0cyA9IHRlc3RVc2VyUHJvamVjdHM7XG4gICAgICBpZiAodHlwZW9mIGdsb2JhbC5zYXZlVGVzdFByb2plY3RzID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIGdsb2JhbC5zYXZlVGVzdFByb2plY3RzKCk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgc3VjY2VzczogdHJ1ZSwgZGF0YToge30gfSk7XG4gICAgICBicmVhaztcbiAgICAgIFxuICAgIGRlZmF1bHQ6XG4gICAgICByZXMuc3RhdHVzKDQwNSkuanNvbih7IHN1Y2Nlc3M6IGZhbHNlLCBtZXNzYWdlOiAnTWV0aG9kIG5vdCBhbGxvd2VkJyB9KTtcbiAgICAgIGJyZWFrO1xuICB9XG59XG5cbi8vIEhhbmRsZSBkZW1vIG1vZGVcbmZ1bmN0aW9uIGhhbmRsZURlbW9Nb2RlKHJlcSwgcmVzLCBpZCkge1xuICAvLyDQlNC70Y8g0YDQtdC20LjQvNCwINC00LXQvNC+0L3RgdGC0YDQsNGG0LjQuCDQuNGB0L/QvtC70YzQt9GD0LXQvCDQstGB0LUg0L/RgNC+0LXQutGC0Ysg0LHQtdC3INC/0YDQvtCy0LXRgNC60Lgg0LLQu9Cw0LTQtdC70YzRhtCwXG4gIGNvbnNvbGUubG9nKCdEZW1vIG1vZGUgYWN0aXZhdGVkIGZvciBwcm9qZWN0IElEOicsIGlkKTtcbiAgY29uc29sZS5sb2coJ0F2YWlsYWJsZSB0ZXN0IHByb2plY3RzOicsIHRlc3RVc2VyUHJvamVjdHMubGVuZ3RoKTtcbiAgXG4gIC8vINCf0YDQvtCy0LXRgNGP0LXQvCwg0YHRg9GJ0LXRgdGC0LLRg9GO0YIg0LvQuCDQv9GA0L7QtdC60YLRi1xuICBpZiAoIXRlc3RVc2VyUHJvamVjdHMgfHwgdGVzdFVzZXJQcm9qZWN0cy5sZW5ndGggPT09IDApIHtcbiAgICBjb25zb2xlLmxvZygnTm8gdGVzdCBwcm9qZWN0cyBhdmFpbGFibGUnKTtcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLCBcbiAgICAgIG1lc3NhZ2U6ICdObyBwcm9qZWN0cyBhdmFpbGFibGUgaW4gZGVtbyBtb2RlJ1xuICAgIH0pO1xuICB9XG4gIFxuICAvLyDQldGB0LvQuCDQt9Cw0L/RgNCw0YjQuNCy0LDQtdGC0YHRjyDQutC+0L3QutGA0LXRgtC90YvQuSDQv9GA0L7QtdC60YJcbiAgaWYgKGlkKSB7XG4gICAgLy8g0J/Ri9GC0LDQtdC80YHRjyDQvdCw0LnRgtC4INC/0YDQvtC10LrRgiDQv9C+IElEINCx0LXQtyDQv9GA0L7QstC10YDQutC4INCy0LvQsNC00LXQu9GM0YbQsFxuICAgIGxldCBwcm9qZWN0ID0gdGVzdFVzZXJQcm9qZWN0cy5maW5kKHAgPT4gcC5faWQgPT09IGlkKTtcbiAgICBcbiAgICAvLyDQldGB0LvQuCDQv9GA0L7QtdC60YIg0L3QtSDQvdCw0LnQtNC10L0g0L/QviDRgtC+0YfQvdC+0LzRgyDRgdC+0LLQv9Cw0LTQtdC90LjRjiwg0L/RgNC+0LHRg9C10Lwg0L3QsNC50YLQuCDQv9C+INGH0LDRgdGC0LjRh9C90L7QvNGDINGB0L7QstC/0LDQtNC10L3QuNGOXG4gICAgaWYgKCFwcm9qZWN0KSB7XG4gICAgICBjb25zb2xlLmxvZygnVHJ5aW5nIHBhcnRpYWwgbWF0Y2ggZm9yIElEOicsIGlkKTtcbiAgICAgIHByb2plY3QgPSB0ZXN0VXNlclByb2plY3RzLmZpbmQocCA9PiBwLl9pZCAmJiBwLl9pZC50b1N0cmluZygpLmluY2x1ZGVzKGlkKSk7XG4gICAgfVxuICAgIFxuICAgIC8vINCV0YHQu9C4INC/0YDQvtC10LrRgiDQstGB0LUg0LXRidC1INC90LUg0L3QsNC50LTQtdC9LCDQstC+0LfQstGA0LDRidCw0LXQvCDQv9C10YDQstGL0Lkg0L/RgNC+0LXQutGCICjQtNC70Y8g0LTQtdC80L7QvdGB0YLRgNCw0YbQuNC4KVxuICAgIGlmICghcHJvamVjdCAmJiB0ZXN0VXNlclByb2plY3RzLmxlbmd0aCA+IDApIHtcbiAgICAgIGNvbnNvbGUubG9nKCdVc2luZyBmaXJzdCBhdmFpbGFibGUgcHJvamVjdCBmb3IgZGVtbycpO1xuICAgICAgcHJvamVjdCA9IHRlc3RVc2VyUHJvamVjdHNbMF07XG4gICAgfVxuICAgIFxuICAgIGlmIChwcm9qZWN0KSB7XG4gICAgICBjb25zb2xlLmxvZyhgUmV0dXJuaW5nIHByb2plY3Q6ICR7cHJvamVjdC5uYW1lfWApO1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcHJvamVjdCB9KTtcbiAgICB9XG4gIH1cbiAgXG4gIC8vINCV0YHQu9C4INC/0YDQvtC10LrRgiDQvdC1INC90LDQudC00LXQvSwg0LLQvtC30LLRgNCw0YnQsNC10Lwg0L7RiNC40LHQutGDXG4gIGNvbnNvbGUubG9nKCdQcm9qZWN0IG5vdCBmb3VuZCBpbiBkZW1vIG1vZGUnKTtcbiAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHsgc3VjY2VzczogZmFsc2UsIG1lc3NhZ2U6ICdQcm9qZWN0IG5vdCBmb3VuZCcgfSk7XG59XG4iXSwibmFtZXMiOlsiZGJDb25uZWN0IiwiUHJvamVjdCIsImdldFNlc3Npb24iLCJURVNUX1VTRVJfSURTIiwidGVzdFVzZXJQcm9qZWN0cyIsImdsb2JhbCIsInNhdmVUZXN0UHJvamVjdHMiLCJjb25zb2xlIiwiZXJyb3IiLCJoYW5kbGVyIiwicmVxIiwicmVzIiwic2Vzc2lvbiIsImlkIiwicXVlcnkiLCJkZW1vTW9kZSIsImRlbW8iLCJsb2ciLCJ1c2VySWQiLCJ1c2VyIiwidXNlcm5hbWUiLCJtZXRob2QiLCJoYW5kbGVEZW1vTW9kZSIsInN0YXR1cyIsImpzb24iLCJtZXNzYWdlIiwiaW5jbHVkZXMiLCJoYW5kbGVUZXN0VXNlciIsInByb2plY3QiLCJmaW5kT25lIiwiX2lkIiwib3duZXIiLCJzdWNjZXNzIiwiZGF0YSIsImZpbmRPbmVBbmRVcGRhdGUiLCJib2R5IiwidXBkYXRlZEF0IiwiRGF0ZSIsIm5vdyIsIm5ldyIsInJ1blZhbGlkYXRvcnMiLCJkZWxldGVkUHJvamVjdCIsImZpbmRPbmVBbmREZWxldGUiLCJsZW5ndGgiLCJtYXAiLCJwIiwibmFtZSIsImZpbmQiLCJwcm9qZWN0Q29weSIsIkpTT04iLCJwYXJzZSIsInN0cmluZ2lmeSIsInByb2plY3RJbmRleCIsImZpbmRJbmRleCIsIm9yaWdpbmFsT3duZXIiLCJ0b0lTT1N0cmluZyIsInVwZGF0ZWRQcm9qZWN0Q29weSIsInByb2plY3RUb0RlbGV0ZSIsImZpbHRlciIsInRvU3RyaW5nIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./pages/api/projects/[id].js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = (__webpack_exec__("(api)/./pages/api/projects/[id].js"));
module.exports = __webpack_exports__;

})();