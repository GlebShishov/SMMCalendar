"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/projects/[id]/export-csv";
exports.ids = ["pages/api/projects/[id]/export-csv"];
exports.modules = {

/***/ "mongoose":
/*!***************************!*\
  !*** external "mongoose" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("mongoose");

/***/ }),

/***/ "next-auth/react":
/*!**********************************!*\
  !*** external "next-auth/react" ***!
  \**********************************/
/***/ ((module) => {

module.exports = require("next-auth/react");

/***/ }),

/***/ "(api)/./lib/dbConnect.js":
/*!**************************!*\
  !*** ./lib/dbConnect.js ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongoose */ \"mongoose\");\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongoose__WEBPACK_IMPORTED_MODULE_0__);\n\nconst MONGODB_URI = process.env.MONGODB_URI || \"mongodb://localhost:27017/smm-calendar\";\nif (!MONGODB_URI) {\n    throw new Error(\"Please define the MONGODB_URI environment variable\");\n}\n/**\n * Global is used here to maintain a cached connection across hot reloads\n * in development. This prevents connections growing exponentially\n * during API Route usage.\n */ let cached = global.mongoose;\nif (!cached) {\n    cached = global.mongoose = {\n        conn: null,\n        promise: null\n    };\n}\nasync function dbConnect() {\n    if (cached.conn) {\n        return cached.conn;\n    }\n    if (!cached.promise) {\n        const opts = {\n            bufferCommands: false\n        };\n        cached.promise = mongoose__WEBPACK_IMPORTED_MODULE_0___default().connect(MONGODB_URI, opts).then((mongoose)=>{\n            return mongoose;\n        });\n    }\n    cached.conn = await cached.promise;\n    return cached.conn;\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (dbConnect);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvZGJDb25uZWN0LmpzLmpzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFnQztBQUVoQyxNQUFNQyxXQUFXLEdBQUdDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDRixXQUFXLElBQUksd0NBQXdDO0FBRXZGLElBQUksQ0FBQ0EsV0FBVyxFQUFFO0lBQ2hCLE1BQU0sSUFBSUcsS0FBSyxDQUNiLG9EQUFvRCxDQUNyRCxDQUFDO0FBQ0osQ0FBQztBQUVEOzs7O0NBSUMsR0FDRCxJQUFJQyxNQUFNLEdBQUdDLE1BQU0sQ0FBQ04sUUFBUTtBQUU1QixJQUFJLENBQUNLLE1BQU0sRUFBRTtJQUNYQSxNQUFNLEdBQUdDLE1BQU0sQ0FBQ04sUUFBUSxHQUFHO1FBQUVPLElBQUksRUFBRSxJQUFJO1FBQUVDLE9BQU8sRUFBRSxJQUFJO0tBQUUsQ0FBQztBQUMzRCxDQUFDO0FBRUQsZUFBZUMsU0FBUyxHQUFHO0lBQ3pCLElBQUlKLE1BQU0sQ0FBQ0UsSUFBSSxFQUFFO1FBQ2YsT0FBT0YsTUFBTSxDQUFDRSxJQUFJLENBQUM7SUFDckIsQ0FBQztJQUVELElBQUksQ0FBQ0YsTUFBTSxDQUFDRyxPQUFPLEVBQUU7UUFDbkIsTUFBTUUsSUFBSSxHQUFHO1lBQ1hDLGNBQWMsRUFBRSxLQUFLO1NBQ3RCO1FBRUROLE1BQU0sQ0FBQ0csT0FBTyxHQUFHUix1REFBZ0IsQ0FBQ0MsV0FBVyxFQUFFUyxJQUFJLENBQUMsQ0FBQ0csSUFBSSxDQUFDLENBQUNiLFFBQVEsR0FBSztZQUN0RSxPQUFPQSxRQUFRLENBQUM7UUFDbEIsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDO0lBQ0RLLE1BQU0sQ0FBQ0UsSUFBSSxHQUFHLE1BQU1GLE1BQU0sQ0FBQ0csT0FBTyxDQUFDO0lBQ25DLE9BQU9ILE1BQU0sQ0FBQ0UsSUFBSSxDQUFDO0FBQ3JCLENBQUM7QUFFRCxpRUFBZUUsU0FBUyxFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc21tLWNvbnRlbnQtY2FsZW5kYXIvLi9saWIvZGJDb25uZWN0LmpzPzFkM2IiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG1vbmdvb3NlIGZyb20gJ21vbmdvb3NlJztcblxuY29uc3QgTU9OR09EQl9VUkkgPSBwcm9jZXNzLmVudi5NT05HT0RCX1VSSSB8fCAnbW9uZ29kYjovL2xvY2FsaG9zdDoyNzAxNy9zbW0tY2FsZW5kYXInO1xuXG5pZiAoIU1PTkdPREJfVVJJKSB7XG4gIHRocm93IG5ldyBFcnJvcihcbiAgICAnUGxlYXNlIGRlZmluZSB0aGUgTU9OR09EQl9VUkkgZW52aXJvbm1lbnQgdmFyaWFibGUnXG4gICk7XG59XG5cbi8qKlxuICogR2xvYmFsIGlzIHVzZWQgaGVyZSB0byBtYWludGFpbiBhIGNhY2hlZCBjb25uZWN0aW9uIGFjcm9zcyBob3QgcmVsb2Fkc1xuICogaW4gZGV2ZWxvcG1lbnQuIFRoaXMgcHJldmVudHMgY29ubmVjdGlvbnMgZ3Jvd2luZyBleHBvbmVudGlhbGx5XG4gKiBkdXJpbmcgQVBJIFJvdXRlIHVzYWdlLlxuICovXG5sZXQgY2FjaGVkID0gZ2xvYmFsLm1vbmdvb3NlO1xuXG5pZiAoIWNhY2hlZCkge1xuICBjYWNoZWQgPSBnbG9iYWwubW9uZ29vc2UgPSB7IGNvbm46IG51bGwsIHByb21pc2U6IG51bGwgfTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gZGJDb25uZWN0KCkge1xuICBpZiAoY2FjaGVkLmNvbm4pIHtcbiAgICByZXR1cm4gY2FjaGVkLmNvbm47XG4gIH1cblxuICBpZiAoIWNhY2hlZC5wcm9taXNlKSB7XG4gICAgY29uc3Qgb3B0cyA9IHtcbiAgICAgIGJ1ZmZlckNvbW1hbmRzOiBmYWxzZSxcbiAgICB9O1xuXG4gICAgY2FjaGVkLnByb21pc2UgPSBtb25nb29zZS5jb25uZWN0KE1PTkdPREJfVVJJLCBvcHRzKS50aGVuKChtb25nb29zZSkgPT4ge1xuICAgICAgcmV0dXJuIG1vbmdvb3NlO1xuICAgIH0pO1xuICB9XG4gIGNhY2hlZC5jb25uID0gYXdhaXQgY2FjaGVkLnByb21pc2U7XG4gIHJldHVybiBjYWNoZWQuY29ubjtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZGJDb25uZWN0O1xuIl0sIm5hbWVzIjpbIm1vbmdvb3NlIiwiTU9OR09EQl9VUkkiLCJwcm9jZXNzIiwiZW52IiwiRXJyb3IiLCJjYWNoZWQiLCJnbG9iYWwiLCJjb25uIiwicHJvbWlzZSIsImRiQ29ubmVjdCIsIm9wdHMiLCJidWZmZXJDb21tYW5kcyIsImNvbm5lY3QiLCJ0aGVuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./lib/dbConnect.js\n");

/***/ }),

/***/ "(api)/./models/Project.js":
/*!***************************!*\
  !*** ./models/Project.js ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongoose */ \"mongoose\");\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongoose__WEBPACK_IMPORTED_MODULE_0__);\n\nconst DayContentSchema = new (mongoose__WEBPACK_IMPORTED_MODULE_0___default().Schema)({\n    socialNetwork: {\n        type: String,\n        default: \"\"\n    },\n    images: {\n        type: [\n            String\n        ],\n        default: []\n    },\n    text: {\n        type: String,\n        default: \"\"\n    }\n});\nconst ProjectSchema = new (mongoose__WEBPACK_IMPORTED_MODULE_0___default().Schema)({\n    name: {\n        type: String,\n        required: [\n            true,\n            \"Please provide a project name\"\n        ],\n        trim: true\n    },\n    owner: {\n        type: (mongoose__WEBPACK_IMPORTED_MODULE_0___default().Schema.Types.ObjectId),\n        ref: \"User\",\n        required: true\n    },\n    days: {\n        type: [\n            DayContentSchema\n        ],\n        default: Array(7).fill({\n            socialNetwork: \"\",\n            images: [],\n            text: \"\"\n        })\n    },\n    companyName: {\n        type: String,\n        default: \"\"\n    },\n    companyDescription: {\n        type: String,\n        default: \"\"\n    },\n    companyWebsite: {\n        type: String,\n        default: \"\"\n    },\n    socialLinks: {\n        type: Map,\n        of: String,\n        default: {}\n    },\n    imagePrompt: {\n        type: String,\n        default: \"\"\n    },\n    createdAt: {\n        type: Date,\n        default: Date.now\n    },\n    updatedAt: {\n        type: Date,\n        default: Date.now\n    }\n});\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((mongoose__WEBPACK_IMPORTED_MODULE_0___default().models.Project) || mongoose__WEBPACK_IMPORTED_MODULE_0___default().model(\"Project\", ProjectSchema));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9tb2RlbHMvUHJvamVjdC5qcy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBZ0M7QUFFaEMsTUFBTUMsZ0JBQWdCLEdBQUcsSUFBSUQsd0RBQWUsQ0FBQztJQUMzQ0csYUFBYSxFQUFFO1FBQ2JDLElBQUksRUFBRUMsTUFBTTtRQUNaQyxPQUFPLEVBQUUsRUFBRTtLQUNaO0lBQ0RDLE1BQU0sRUFBRTtRQUNOSCxJQUFJLEVBQUU7WUFBQ0MsTUFBTTtTQUFDO1FBQ2RDLE9BQU8sRUFBRSxFQUFFO0tBQ1o7SUFDREUsSUFBSSxFQUFFO1FBQ0pKLElBQUksRUFBRUMsTUFBTTtRQUNaQyxPQUFPLEVBQUUsRUFBRTtLQUNaO0NBQ0YsQ0FBQztBQUVGLE1BQU1HLGFBQWEsR0FBRyxJQUFJVCx3REFBZSxDQUFDO0lBQ3hDVSxJQUFJLEVBQUU7UUFDSk4sSUFBSSxFQUFFQyxNQUFNO1FBQ1pNLFFBQVEsRUFBRTtZQUFDLElBQUk7WUFBRSwrQkFBK0I7U0FBQztRQUNqREMsSUFBSSxFQUFFLElBQUk7S0FDWDtJQUNEQyxLQUFLLEVBQUU7UUFDTFQsSUFBSSxFQUFFSix1RUFBOEI7UUFDcENnQixHQUFHLEVBQUUsTUFBTTtRQUNYTCxRQUFRLEVBQUUsSUFBSTtLQUNmO0lBQ0RNLElBQUksRUFBRTtRQUNKYixJQUFJLEVBQUU7WUFBQ0gsZ0JBQWdCO1NBQUM7UUFDeEJLLE9BQU8sRUFBRVksS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDQyxJQUFJLENBQUM7WUFDckJoQixhQUFhLEVBQUUsRUFBRTtZQUNqQkksTUFBTSxFQUFFLEVBQUU7WUFDVkMsSUFBSSxFQUFFLEVBQUU7U0FDVCxDQUFDO0tBQ0g7SUFDRFksV0FBVyxFQUFFO1FBQ1hoQixJQUFJLEVBQUVDLE1BQU07UUFDWkMsT0FBTyxFQUFFLEVBQUU7S0FDWjtJQUNEZSxrQkFBa0IsRUFBRTtRQUNsQmpCLElBQUksRUFBRUMsTUFBTTtRQUNaQyxPQUFPLEVBQUUsRUFBRTtLQUNaO0lBQ0RnQixjQUFjLEVBQUU7UUFDZGxCLElBQUksRUFBRUMsTUFBTTtRQUNaQyxPQUFPLEVBQUUsRUFBRTtLQUNaO0lBQ0RpQixXQUFXLEVBQUU7UUFDWG5CLElBQUksRUFBRW9CLEdBQUc7UUFDVEMsRUFBRSxFQUFFcEIsTUFBTTtRQUNWQyxPQUFPLEVBQUUsRUFBRTtLQUNaO0lBQ0RvQixXQUFXLEVBQUU7UUFDWHRCLElBQUksRUFBRUMsTUFBTTtRQUNaQyxPQUFPLEVBQUUsRUFBRTtLQUNaO0lBQ0RxQixTQUFTLEVBQUU7UUFDVHZCLElBQUksRUFBRXdCLElBQUk7UUFDVnRCLE9BQU8sRUFBRXNCLElBQUksQ0FBQ0MsR0FBRztLQUNsQjtJQUNEQyxTQUFTLEVBQUU7UUFDVDFCLElBQUksRUFBRXdCLElBQUk7UUFDVnRCLE9BQU8sRUFBRXNCLElBQUksQ0FBQ0MsR0FBRztLQUNsQjtDQUNGLENBQUM7QUFFRixpRUFBZTdCLGdFQUF1QixJQUFJQSxxREFBYyxDQUFDLFNBQVMsRUFBRVMsYUFBYSxDQUFDLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zbW0tY29udGVudC1jYWxlbmRhci8uL21vZGVscy9Qcm9qZWN0LmpzP2NiMTIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG1vbmdvb3NlIGZyb20gJ21vbmdvb3NlJztcblxuY29uc3QgRGF5Q29udGVudFNjaGVtYSA9IG5ldyBtb25nb29zZS5TY2hlbWEoe1xuICBzb2NpYWxOZXR3b3JrOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIGRlZmF1bHQ6ICcnLFxuICB9LFxuICBpbWFnZXM6IHtcbiAgICB0eXBlOiBbU3RyaW5nXSxcbiAgICBkZWZhdWx0OiBbXSxcbiAgfSxcbiAgdGV4dDoge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICBkZWZhdWx0OiAnJyxcbiAgfSxcbn0pO1xuXG5jb25zdCBQcm9qZWN0U2NoZW1hID0gbmV3IG1vbmdvb3NlLlNjaGVtYSh7XG4gIG5hbWU6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgcmVxdWlyZWQ6IFt0cnVlLCAnUGxlYXNlIHByb3ZpZGUgYSBwcm9qZWN0IG5hbWUnXSxcbiAgICB0cmltOiB0cnVlLFxuICB9LFxuICBvd25lcjoge1xuICAgIHR5cGU6IG1vbmdvb3NlLlNjaGVtYS5UeXBlcy5PYmplY3RJZCxcbiAgICByZWY6ICdVc2VyJyxcbiAgICByZXF1aXJlZDogdHJ1ZSxcbiAgfSxcbiAgZGF5czoge1xuICAgIHR5cGU6IFtEYXlDb250ZW50U2NoZW1hXSxcbiAgICBkZWZhdWx0OiBBcnJheSg3KS5maWxsKHtcbiAgICAgIHNvY2lhbE5ldHdvcms6ICcnLFxuICAgICAgaW1hZ2VzOiBbXSxcbiAgICAgIHRleHQ6ICcnLFxuICAgIH0pLFxuICB9LFxuICBjb21wYW55TmFtZToge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICBkZWZhdWx0OiAnJyxcbiAgfSxcbiAgY29tcGFueURlc2NyaXB0aW9uOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIGRlZmF1bHQ6ICcnLFxuICB9LFxuICBjb21wYW55V2Vic2l0ZToge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICBkZWZhdWx0OiAnJyxcbiAgfSxcbiAgc29jaWFsTGlua3M6IHtcbiAgICB0eXBlOiBNYXAsXG4gICAgb2Y6IFN0cmluZyxcbiAgICBkZWZhdWx0OiB7fSxcbiAgfSxcbiAgaW1hZ2VQcm9tcHQ6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgZGVmYXVsdDogJycsXG4gIH0sXG4gIGNyZWF0ZWRBdDoge1xuICAgIHR5cGU6IERhdGUsXG4gICAgZGVmYXVsdDogRGF0ZS5ub3csXG4gIH0sXG4gIHVwZGF0ZWRBdDoge1xuICAgIHR5cGU6IERhdGUsXG4gICAgZGVmYXVsdDogRGF0ZS5ub3csXG4gIH0sXG59KTtcblxuZXhwb3J0IGRlZmF1bHQgbW9uZ29vc2UubW9kZWxzLlByb2plY3QgfHwgbW9uZ29vc2UubW9kZWwoJ1Byb2plY3QnLCBQcm9qZWN0U2NoZW1hKTtcbiJdLCJuYW1lcyI6WyJtb25nb29zZSIsIkRheUNvbnRlbnRTY2hlbWEiLCJTY2hlbWEiLCJzb2NpYWxOZXR3b3JrIiwidHlwZSIsIlN0cmluZyIsImRlZmF1bHQiLCJpbWFnZXMiLCJ0ZXh0IiwiUHJvamVjdFNjaGVtYSIsIm5hbWUiLCJyZXF1aXJlZCIsInRyaW0iLCJvd25lciIsIlR5cGVzIiwiT2JqZWN0SWQiLCJyZWYiLCJkYXlzIiwiQXJyYXkiLCJmaWxsIiwiY29tcGFueU5hbWUiLCJjb21wYW55RGVzY3JpcHRpb24iLCJjb21wYW55V2Vic2l0ZSIsInNvY2lhbExpbmtzIiwiTWFwIiwib2YiLCJpbWFnZVByb21wdCIsImNyZWF0ZWRBdCIsIkRhdGUiLCJub3ciLCJ1cGRhdGVkQXQiLCJtb2RlbHMiLCJQcm9qZWN0IiwibW9kZWwiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./models/Project.js\n");

/***/ }),

/***/ "(api)/./pages/api/projects/[id]/export-csv.js":
/*!***********************************************!*\
  !*** ./pages/api/projects/[id]/export-csv.js ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _lib_dbConnect__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../lib/dbConnect */ \"(api)/./lib/dbConnect.js\");\n/* harmony import */ var _models_Project__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../models/Project */ \"(api)/./models/Project.js\");\n/* harmony import */ var next_auth_react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next-auth/react */ \"next-auth/react\");\n/* harmony import */ var next_auth_react__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_auth_react__WEBPACK_IMPORTED_MODULE_2__);\n\n\n\nasync function handler(req, res) {\n    if (req.method !== \"GET\") {\n        return res.status(405).json({\n            success: false,\n            message: \"Method not allowed\"\n        });\n    }\n    const { id  } = req.query;\n    const isDemoMode = req.query.demo === \"true\";\n    try {\n        await (0,_lib_dbConnect__WEBPACK_IMPORTED_MODULE_0__[\"default\"])();\n        // Проверка авторизации (пропускаем в режиме демонстрации)\n        if (!isDemoMode) {\n            const session1 = await (0,next_auth_react__WEBPACK_IMPORTED_MODULE_2__.getSession)({\n                req\n            });\n            if (!session1) {\n                return res.status(401).json({\n                    success: false,\n                    message: \"Unauthorized\"\n                });\n            }\n        }\n        // Находим проект по ID\n        const project = await _models_Project__WEBPACK_IMPORTED_MODULE_1__[\"default\"].findById(id);\n        if (!project) {\n            return res.status(404).json({\n                success: false,\n                message: \"Project not found\"\n            });\n        }\n        // Проверка прав доступа (пропускаем в режиме демонстрации)\n        if (!isDemoMode && project.userId.toString() !== session.user.id) {\n            return res.status(403).json({\n                success: false,\n                message: \"Forbidden\"\n            });\n        }\n        // Генерируем CSV данные\n        const csvRows = [];\n        // Заголовок CSV\n        csvRows.push([\n            \"День\",\n            \"Дата\",\n            \"Социальная сеть\",\n            \"Тип контента\",\n            \"Текст\",\n            \"Изображения\"\n        ].join(\",\"));\n        // Данные проекта\n        project.days.forEach((day, index)=>{\n            const date = day.date ? new Date(day.date).toLocaleDateString(\"ru-RU\") : \"\";\n            const socialNetwork = day.socialNetwork || \"\";\n            const contentType = day.contentType || \"\";\n            // Экранируем текст для CSV (заменяем кавычки и удаляем HTML-теги)\n            let text = day.text || \"\";\n            text = text.replace(/<[^>]*>/g, \"\"); // Удаляем HTML-теги\n            text = text.replace(/\"/g, '\"\"'); // Экранируем кавычки\n            // Если текст содержит запятые или переносы строк, заключаем его в кавычки\n            if (text.includes(\",\") || text.includes(\"\\\\n\") || text.includes('\"')) {\n                text = `\"${text}\"`;\n            }\n            // Объединяем URL изображений через точку с запятой\n            const images = day.images ? day.images.join(\"; \") : \"\";\n            csvRows.push([\n                index + 1,\n                date,\n                socialNetwork,\n                contentType,\n                text,\n                images\n            ].join(\",\"));\n        });\n        // Объединяем строки с переносами строк\n        const csvContent = csvRows.join(\"\\\\n\");\n        // Отправляем CSV данные\n        res.setHeader(\"Content-Type\", \"text/csv; charset=utf-8\");\n        res.setHeader(\"Content-Disposition\", `attachment; filename=\"${project.name.replace(/[^a-zA-Z0-9]/g, \"_\")}_export.csv\"`);\n        return res.status(200).send(csvContent);\n    } catch (error) {\n        console.error(\"Error exporting project to CSV:\", error);\n        return res.status(500).json({\n            success: false,\n            message: \"Error exporting project to CSV\"\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvcHJvamVjdHMvW2lkXS9leHBvcnQtY3N2LmpzLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQWtEO0FBQ0Q7QUFDSjtBQUU5QixlQUFlRyxPQUFPLENBQUNDLEdBQUcsRUFBRUMsR0FBRyxFQUFFO0lBQzlDLElBQUlELEdBQUcsQ0FBQ0UsTUFBTSxLQUFLLEtBQUssRUFBRTtRQUN4QixPQUFPRCxHQUFHLENBQUNFLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDO1lBQUVDLE9BQU8sRUFBRSxLQUFLO1lBQUVDLE9BQU8sRUFBRSxvQkFBb0I7U0FBRSxDQUFDLENBQUM7SUFDakYsQ0FBQztJQUVELE1BQU0sRUFBRUMsRUFBRSxHQUFFLEdBQUdQLEdBQUcsQ0FBQ1EsS0FBSztJQUN4QixNQUFNQyxVQUFVLEdBQUdULEdBQUcsQ0FBQ1EsS0FBSyxDQUFDRSxJQUFJLEtBQUssTUFBTTtJQUU1QyxJQUFJO1FBQ0YsTUFBTWQsMERBQVMsRUFBRSxDQUFDO1FBRWxCLDBEQUEwRDtRQUMxRCxJQUFJLENBQUNhLFVBQVUsRUFBRTtZQUNmLE1BQU1FLFFBQU8sR0FBRyxNQUFNYiwyREFBVSxDQUFDO2dCQUFFRSxHQUFHO2FBQUUsQ0FBQztZQUN6QyxJQUFJLENBQUNXLFFBQU8sRUFBRTtnQkFDWixPQUFPVixHQUFHLENBQUNFLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDO29CQUFFQyxPQUFPLEVBQUUsS0FBSztvQkFBRUMsT0FBTyxFQUFFLGNBQWM7aUJBQUUsQ0FBQyxDQUFDO1lBQzNFLENBQUM7UUFDSCxDQUFDO1FBRUQsdUJBQXVCO1FBQ3ZCLE1BQU1NLE9BQU8sR0FBRyxNQUFNZixnRUFBZ0IsQ0FBQ1UsRUFBRSxDQUFDO1FBQzFDLElBQUksQ0FBQ0ssT0FBTyxFQUFFO1lBQ1osT0FBT1gsR0FBRyxDQUFDRSxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQztnQkFBRUMsT0FBTyxFQUFFLEtBQUs7Z0JBQUVDLE9BQU8sRUFBRSxtQkFBbUI7YUFBRSxDQUFDLENBQUM7UUFDaEYsQ0FBQztRQUVELDJEQUEyRDtRQUMzRCxJQUFJLENBQUNHLFVBQVUsSUFBSUcsT0FBTyxDQUFDRSxNQUFNLENBQUNDLFFBQVEsRUFBRSxLQUFLSixPQUFPLENBQUNLLElBQUksQ0FBQ1QsRUFBRSxFQUFFO1lBQ2hFLE9BQU9OLEdBQUcsQ0FBQ0UsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7Z0JBQUVDLE9BQU8sRUFBRSxLQUFLO2dCQUFFQyxPQUFPLEVBQUUsV0FBVzthQUFFLENBQUMsQ0FBQztRQUN4RSxDQUFDO1FBRUQsd0JBQXdCO1FBQ3hCLE1BQU1XLE9BQU8sR0FBRyxFQUFFO1FBRWxCLGdCQUFnQjtRQUNoQkEsT0FBTyxDQUFDQyxJQUFJLENBQUM7WUFBQyxNQUFNO1lBQUUsTUFBTTtZQUFFLGlCQUFpQjtZQUFFLGNBQWM7WUFBRSxPQUFPO1lBQUUsYUFBYTtTQUFDLENBQUNDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBRXBHLGlCQUFpQjtRQUNqQlAsT0FBTyxDQUFDUSxJQUFJLENBQUNDLE9BQU8sQ0FBQyxDQUFDQyxHQUFHLEVBQUVDLEtBQUssR0FBSztZQUNuQyxNQUFNQyxJQUFJLEdBQUdGLEdBQUcsQ0FBQ0UsSUFBSSxHQUFHLElBQUlDLElBQUksQ0FBQ0gsR0FBRyxDQUFDRSxJQUFJLENBQUMsQ0FBQ0Usa0JBQWtCLENBQUMsT0FBTyxDQUFDLEdBQUcsRUFBRTtZQUMzRSxNQUFNQyxhQUFhLEdBQUdMLEdBQUcsQ0FBQ0ssYUFBYSxJQUFJLEVBQUU7WUFDN0MsTUFBTUMsV0FBVyxHQUFHTixHQUFHLENBQUNNLFdBQVcsSUFBSSxFQUFFO1lBRXpDLGtFQUFrRTtZQUNsRSxJQUFJQyxJQUFJLEdBQUdQLEdBQUcsQ0FBQ08sSUFBSSxJQUFJLEVBQUU7WUFDekJBLElBQUksR0FBR0EsSUFBSSxDQUFDQyxPQUFPLGFBQWEsRUFBRSxDQUFDLENBQUMsQ0FBQyxvQkFBb0I7WUFDekRELElBQUksR0FBR0EsSUFBSSxDQUFDQyxPQUFPLE9BQU8sSUFBSSxDQUFDLENBQUMsQ0FBQyxxQkFBcUI7WUFFdEQsMEVBQTBFO1lBQzFFLElBQUlELElBQUksQ0FBQ0UsUUFBUSxDQUFDLEdBQUcsQ0FBQyxJQUFJRixJQUFJLENBQUNFLFFBQVEsQ0FBQyxLQUFLLENBQUMsSUFBSUYsSUFBSSxDQUFDRSxRQUFRLENBQUMsR0FBRyxDQUFDLEVBQUU7Z0JBQ3BFRixJQUFJLEdBQUcsQ0FBQyxDQUFDLEVBQUVBLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUNyQixDQUFDO1lBRUQsbURBQW1EO1lBQ25ELE1BQU1HLE1BQU0sR0FBR1YsR0FBRyxDQUFDVSxNQUFNLEdBQUdWLEdBQUcsQ0FBQ1UsTUFBTSxDQUFDYixJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRTtZQUV0REYsT0FBTyxDQUFDQyxJQUFJLENBQUM7Z0JBQ1hLLEtBQUssR0FBRyxDQUFDO2dCQUNUQyxJQUFJO2dCQUNKRyxhQUFhO2dCQUNiQyxXQUFXO2dCQUNYQyxJQUFJO2dCQUNKRyxNQUFNO2FBQ1AsQ0FBQ2IsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDZixDQUFDLENBQUMsQ0FBQztRQUVILHVDQUF1QztRQUN2QyxNQUFNYyxVQUFVLEdBQUdoQixPQUFPLENBQUNFLElBQUksQ0FBQyxLQUFLLENBQUM7UUFFdEMsd0JBQXdCO1FBQ3hCbEIsR0FBRyxDQUFDaUMsU0FBUyxDQUFDLGNBQWMsRUFBRSx5QkFBeUIsQ0FBQyxDQUFDO1FBQ3pEakMsR0FBRyxDQUFDaUMsU0FBUyxDQUFDLHFCQUFxQixFQUFFLENBQUMsc0JBQXNCLEVBQUV0QixPQUFPLENBQUN1QixJQUFJLENBQUNMLE9BQU8sa0JBQWtCLEdBQUcsQ0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUM7UUFDeEgsT0FBTzdCLEdBQUcsQ0FBQ0UsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDaUMsSUFBSSxDQUFDSCxVQUFVLENBQUMsQ0FBQztJQUUxQyxFQUFFLE9BQU9JLEtBQUssRUFBRTtRQUNkQyxPQUFPLENBQUNELEtBQUssQ0FBQyxpQ0FBaUMsRUFBRUEsS0FBSyxDQUFDLENBQUM7UUFDeEQsT0FBT3BDLEdBQUcsQ0FBQ0UsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7WUFBRUMsT0FBTyxFQUFFLEtBQUs7WUFBRUMsT0FBTyxFQUFFLGdDQUFnQztTQUFFLENBQUMsQ0FBQztJQUM3RixDQUFDO0FBQ0gsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL3NtbS1jb250ZW50LWNhbGVuZGFyLy4vcGFnZXMvYXBpL3Byb2plY3RzL1tpZF0vZXhwb3J0LWNzdi5qcz8zOGEyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBkYkNvbm5lY3QgZnJvbSAnLi4vLi4vLi4vLi4vbGliL2RiQ29ubmVjdCc7XG5pbXBvcnQgUHJvamVjdCBmcm9tICcuLi8uLi8uLi8uLi9tb2RlbHMvUHJvamVjdCc7XG5pbXBvcnQgeyBnZXRTZXNzaW9uIH0gZnJvbSAnbmV4dC1hdXRoL3JlYWN0JztcblxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXEsIHJlcykge1xuICBpZiAocmVxLm1ldGhvZCAhPT0gJ0dFVCcpIHtcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDUpLmpzb24oeyBzdWNjZXNzOiBmYWxzZSwgbWVzc2FnZTogJ01ldGhvZCBub3QgYWxsb3dlZCcgfSk7XG4gIH1cblxuICBjb25zdCB7IGlkIH0gPSByZXEucXVlcnk7XG4gIGNvbnN0IGlzRGVtb01vZGUgPSByZXEucXVlcnkuZGVtbyA9PT0gJ3RydWUnO1xuXG4gIHRyeSB7XG4gICAgYXdhaXQgZGJDb25uZWN0KCk7XG5cbiAgICAvLyDQn9GA0L7QstC10YDQutCwINCw0LLRgtC+0YDQuNC30LDRhtC40LggKNC/0YDQvtC/0YPRgdC60LDQtdC8INCyINGA0LXQttC40LzQtSDQtNC10LzQvtC90YHRgtGA0LDRhtC40LgpXG4gICAgaWYgKCFpc0RlbW9Nb2RlKSB7XG4gICAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgZ2V0U2Vzc2lvbih7IHJlcSB9KTtcbiAgICAgIGlmICghc2Vzc2lvbikge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBzdWNjZXNzOiBmYWxzZSwgbWVzc2FnZTogJ1VuYXV0aG9yaXplZCcgfSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8g0J3QsNGF0L7QtNC40Lwg0L/RgNC+0LXQutGCINC/0L4gSURcbiAgICBjb25zdCBwcm9qZWN0ID0gYXdhaXQgUHJvamVjdC5maW5kQnlJZChpZCk7XG4gICAgaWYgKCFwcm9qZWN0KSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBzdWNjZXNzOiBmYWxzZSwgbWVzc2FnZTogJ1Byb2plY3Qgbm90IGZvdW5kJyB9KTtcbiAgICB9XG5cbiAgICAvLyDQn9GA0L7QstC10YDQutCwINC/0YDQsNCyINC00L7RgdGC0YPQv9CwICjQv9GA0L7Qv9GD0YHQutCw0LXQvCDQsiDRgNC10LbQuNC80LUg0LTQtdC80L7QvdGB0YLRgNCw0YbQuNC4KVxuICAgIGlmICghaXNEZW1vTW9kZSAmJiBwcm9qZWN0LnVzZXJJZC50b1N0cmluZygpICE9PSBzZXNzaW9uLnVzZXIuaWQpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMykuanNvbih7IHN1Y2Nlc3M6IGZhbHNlLCBtZXNzYWdlOiAnRm9yYmlkZGVuJyB9KTtcbiAgICB9XG5cbiAgICAvLyDQk9C10L3QtdGA0LjRgNGD0LXQvCBDU1Yg0LTQsNC90L3Ri9C1XG4gICAgY29uc3QgY3N2Um93cyA9IFtdO1xuICAgIFxuICAgIC8vINCX0LDQs9C+0LvQvtCy0L7QuiBDU1ZcbiAgICBjc3ZSb3dzLnB1c2goWyfQlNC10L3RjCcsICfQlNCw0YLQsCcsICfQodC+0YbQuNCw0LvRjNC90LDRjyDRgdC10YLRjCcsICfQotC40L8g0LrQvtC90YLQtdC90YLQsCcsICfQotC10LrRgdGCJywgJ9CY0LfQvtCx0YDQsNC20LXQvdC40Y8nXS5qb2luKCcsJykpO1xuICAgIFxuICAgIC8vINCU0LDQvdC90YvQtSDQv9GA0L7QtdC60YLQsFxuICAgIHByb2plY3QuZGF5cy5mb3JFYWNoKChkYXksIGluZGV4KSA9PiB7XG4gICAgICBjb25zdCBkYXRlID0gZGF5LmRhdGUgPyBuZXcgRGF0ZShkYXkuZGF0ZSkudG9Mb2NhbGVEYXRlU3RyaW5nKCdydS1SVScpIDogJyc7XG4gICAgICBjb25zdCBzb2NpYWxOZXR3b3JrID0gZGF5LnNvY2lhbE5ldHdvcmsgfHwgJyc7XG4gICAgICBjb25zdCBjb250ZW50VHlwZSA9IGRheS5jb250ZW50VHlwZSB8fCAnJztcbiAgICAgIFxuICAgICAgLy8g0K3QutGA0LDQvdC40YDRg9C10Lwg0YLQtdC60YHRgiDQtNC70Y8gQ1NWICjQt9Cw0LzQtdC90Y/QtdC8INC60LDQstGL0YfQutC4INC4INGD0LTQsNC70Y/QtdC8IEhUTUwt0YLQtdCz0LgpXG4gICAgICBsZXQgdGV4dCA9IGRheS50ZXh0IHx8ICcnO1xuICAgICAgdGV4dCA9IHRleHQucmVwbGFjZSgvPFtePl0qPi9nLCAnJyk7IC8vINCj0LTQsNC70Y/QtdC8IEhUTUwt0YLQtdCz0LhcbiAgICAgIHRleHQgPSB0ZXh0LnJlcGxhY2UoL1wiL2csICdcIlwiJyk7IC8vINCt0LrRgNCw0L3QuNGA0YPQtdC8INC60LDQstGL0YfQutC4XG4gICAgICBcbiAgICAgIC8vINCV0YHQu9C4INGC0LXQutGB0YIg0YHQvtC00LXRgNC20LjRgiDQt9Cw0L/Rj9GC0YvQtSDQuNC70Lgg0L/QtdGA0LXQvdC+0YHRiyDRgdGC0YDQvtC6LCDQt9Cw0LrQu9GO0YfQsNC10Lwg0LXQs9C+INCyINC60LDQstGL0YfQutC4XG4gICAgICBpZiAodGV4dC5pbmNsdWRlcygnLCcpIHx8IHRleHQuaW5jbHVkZXMoJ1xcXFxuJykgfHwgdGV4dC5pbmNsdWRlcygnXCInKSkge1xuICAgICAgICB0ZXh0ID0gYFwiJHt0ZXh0fVwiYDtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8g0J7QsdGK0LXQtNC40L3Rj9C10LwgVVJMINC40LfQvtCx0YDQsNC20LXQvdC40Lkg0YfQtdGA0LXQtyDRgtC+0YfQutGDINGBINC30LDQv9GP0YLQvtC5XG4gICAgICBjb25zdCBpbWFnZXMgPSBkYXkuaW1hZ2VzID8gZGF5LmltYWdlcy5qb2luKCc7ICcpIDogJyc7XG4gICAgICBcbiAgICAgIGNzdlJvd3MucHVzaChbXG4gICAgICAgIGluZGV4ICsgMSxcbiAgICAgICAgZGF0ZSxcbiAgICAgICAgc29jaWFsTmV0d29yayxcbiAgICAgICAgY29udGVudFR5cGUsXG4gICAgICAgIHRleHQsXG4gICAgICAgIGltYWdlc1xuICAgICAgXS5qb2luKCcsJykpO1xuICAgIH0pO1xuICAgIFxuICAgIC8vINCe0LHRitC10LTQuNC90Y/QtdC8INGB0YLRgNC+0LrQuCDRgSDQv9C10YDQtdC90L7RgdCw0LzQuCDRgdGC0YDQvtC6XG4gICAgY29uc3QgY3N2Q29udGVudCA9IGNzdlJvd3Muam9pbignXFxcXG4nKTtcbiAgICBcbiAgICAvLyDQntGC0L/RgNCw0LLQu9GP0LXQvCBDU1Yg0LTQsNC90L3Ri9C1XG4gICAgcmVzLnNldEhlYWRlcignQ29udGVudC1UeXBlJywgJ3RleHQvY3N2OyBjaGFyc2V0PXV0Zi04Jyk7XG4gICAgcmVzLnNldEhlYWRlcignQ29udGVudC1EaXNwb3NpdGlvbicsIGBhdHRhY2htZW50OyBmaWxlbmFtZT1cIiR7cHJvamVjdC5uYW1lLnJlcGxhY2UoL1teYS16QS1aMC05XS9nLCAnXycpfV9leHBvcnQuY3N2XCJgKTtcbiAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLnNlbmQoY3N2Q29udGVudCk7XG4gICAgXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZXhwb3J0aW5nIHByb2plY3QgdG8gQ1NWOicsIGVycm9yKTtcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oeyBzdWNjZXNzOiBmYWxzZSwgbWVzc2FnZTogJ0Vycm9yIGV4cG9ydGluZyBwcm9qZWN0IHRvIENTVicgfSk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJkYkNvbm5lY3QiLCJQcm9qZWN0IiwiZ2V0U2Vzc2lvbiIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJtZXRob2QiLCJzdGF0dXMiLCJqc29uIiwic3VjY2VzcyIsIm1lc3NhZ2UiLCJpZCIsInF1ZXJ5IiwiaXNEZW1vTW9kZSIsImRlbW8iLCJzZXNzaW9uIiwicHJvamVjdCIsImZpbmRCeUlkIiwidXNlcklkIiwidG9TdHJpbmciLCJ1c2VyIiwiY3N2Um93cyIsInB1c2giLCJqb2luIiwiZGF5cyIsImZvckVhY2giLCJkYXkiLCJpbmRleCIsImRhdGUiLCJEYXRlIiwidG9Mb2NhbGVEYXRlU3RyaW5nIiwic29jaWFsTmV0d29yayIsImNvbnRlbnRUeXBlIiwidGV4dCIsInJlcGxhY2UiLCJpbmNsdWRlcyIsImltYWdlcyIsImNzdkNvbnRlbnQiLCJzZXRIZWFkZXIiLCJuYW1lIiwic2VuZCIsImVycm9yIiwiY29uc29sZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./pages/api/projects/[id]/export-csv.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = (__webpack_exec__("(api)/./pages/api/projects/[id]/export-csv.js"));
module.exports = __webpack_exports__;

})();