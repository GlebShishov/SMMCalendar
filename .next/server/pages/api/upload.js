"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/upload";
exports.ids = ["pages/api/upload"];
exports.modules = {

/***/ "formidable":
/*!*****************************!*\
  !*** external "formidable" ***!
  \*****************************/
/***/ ((module) => {

module.exports = require("formidable");

/***/ }),

/***/ "next-auth/react":
/*!**********************************!*\
  !*** external "next-auth/react" ***!
  \**********************************/
/***/ ((module) => {

module.exports = require("next-auth/react");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "(api)/./pages/api/upload.js":
/*!*****************************!*\
  !*** ./pages/api/upload.js ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"config\": () => (/* binding */ config),\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var formidable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! formidable */ \"formidable\");\n/* harmony import */ var formidable__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(formidable__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var next_auth_react__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! next-auth/react */ \"next-auth/react\");\n/* harmony import */ var next_auth_react__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(next_auth_react__WEBPACK_IMPORTED_MODULE_3__);\n\n\n\n\nconst config = {\n    api: {\n        bodyParser: false\n    }\n};\nconst uploadDir = path__WEBPACK_IMPORTED_MODULE_2___default().join(process.cwd(), \"public/uploads\");\n// Test user ID for memory storage\nconst TEST_USER_ID = \"test-user-123\";\n// Ensure upload directory exists\nconst ensureDir = async ()=>{\n    try {\n        await fs__WEBPACK_IMPORTED_MODULE_1__.promises.access(uploadDir);\n    } catch (error) {\n        await fs__WEBPACK_IMPORTED_MODULE_1__.promises.mkdir(uploadDir, {\n            recursive: true\n        });\n    }\n};\n// Функция для очистки имени файла от недопустимых символов\nconst sanitizeFileName = (name)=>{\n    return name.replace(/[^a-zA-Z0-9_-]/g, \"_\");\n};\nasync function handler(req, res) {\n    // Check authentication\n    const session = await (0,next_auth_react__WEBPACK_IMPORTED_MODULE_3__.getSession)({\n        req\n    });\n    if (!session) {\n        return res.status(401).json({\n            message: \"Not authenticated\"\n        });\n    }\n    if (req.method !== \"POST\") {\n        return res.status(405).json({\n            message: \"Method not allowed\"\n        });\n    }\n    try {\n        await ensureDir();\n        const form = new formidable__WEBPACK_IMPORTED_MODULE_0__.IncomingForm({\n            uploadDir,\n            keepExtensions: true,\n            maxFileSize: 10 * 1024 * 1024,\n            multiples: true\n        });\n        form.parse(req, async (err, fields, files)=>{\n            if (err) {\n                return res.status(500).json({\n                    message: \"Upload failed\",\n                    error: err.message\n                });\n            }\n            // Получаем название проекта и дату из полей запроса\n            const projectName = fields.projectName ? sanitizeFileName(fields.projectName[0]) : \"unnamed\";\n            const date = fields.date ? sanitizeFileName(fields.date[0]) : new Date().toISOString().split(\"T\")[0];\n            const dayIndex = fields.dayIndex ? parseInt(fields.dayIndex[0]) : 0;\n            // Обработка одного или нескольких файлов\n            const fileList = files.file;\n            // Если файлов нет, возвращаем ошибку\n            if (!fileList) {\n                return res.status(400).json({\n                    message: \"No files uploaded\"\n                });\n            }\n            // Преобразуем в массив, если это один файл\n            const filesArray = Array.isArray(fileList) ? fileList : [\n                fileList\n            ];\n            if (filesArray.length === 0) {\n                return res.status(400).json({\n                    message: \"No files uploaded\"\n                });\n            }\n            // Обрабатываем каждый файл\n            const uploadedFiles = await Promise.all(filesArray.map(async (file, index)=>{\n                // Формируем имя файла по схеме: название проекта_дата_img_порядковый номер_уникальный идентификатор\n                const originalFilename = file.originalFilename || \"image.jpg\";\n                const ext = path__WEBPACK_IMPORTED_MODULE_2___default().extname(originalFilename);\n                const baseIndex = fields.baseIndex ? parseInt(fields.baseIndex[0]) : 0;\n                const imageIndex = baseIndex + index;\n                // Добавляем уникальный идентификатор (текущее время в миллисекундах + случайное число)\n                const uniqueId = `${Date.now()}_${Math.floor(Math.random() * 10000)}`;\n                const filename = `${projectName}_${date}_img_${imageIndex}_${uniqueId}${ext}`;\n                // Move file to final destination\n                const finalPath = path__WEBPACK_IMPORTED_MODULE_2___default().join(uploadDir, filename);\n                await fs__WEBPACK_IMPORTED_MODULE_1__.promises.rename(file.filepath, finalPath);\n                // Return the path that can be used to access the file\n                return `/uploads/${filename}`;\n            }));\n            // Return the paths that can be used to access the files\n            res.status(200).json({\n                success: true,\n                urls: uploadedFiles\n            });\n        });\n    } catch (error) {\n        console.error(\"Upload error:\", error);\n        // If there's an error with file system operations, provide mock URLs for test user\n        if (session.user.id === TEST_USER_ID) {\n            // Generate fake image URLs for the test user\n            const projectName = \"test_project\";\n            const date = new Date().toISOString().split(\"T\")[0];\n            const mockImageUrls = Array(3).fill().map((_, i)=>`/mock-image-${projectName}_${date}_img_${i}.jpg`);\n            res.status(200).json({\n                success: true,\n                urls: mockImageUrls\n            });\n        } else {\n            res.status(500).json({\n                message: \"Server error\",\n                error: error.message\n            });\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFDLENBQUM7WUFDbkQsTUFBTWlDLGFBQWEsR0FBRzNCLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQzRCLElBQUksRUFBRSxDQUFDdEIsR0FBRyxDQUFDLENBQUN1QixDQUFDLEVBQUVDLENBQUMsR0FBSyxDQUFDLFlBQVksRUFBRXhDLFdBQVcsQ0FBQyxDQUFDLEVBQUVDLElBQUksQ0FBQyxLQUFLLEVBQUV1QyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDdEd0RCxHQUFHLENBQUNFLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDO2dCQUNuQjJDLE9BQU8sRUFBRSxJQUFJO2dCQUNiQyxJQUFJLEVBQUVJLGFBQWE7YUFDcEIsQ0FBQyxDQUFDO1FBQ0wsT0FBTztZQUNMbkQsR0FBRyxDQUFDRSxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQztnQkFBRUMsT0FBTyxFQUFFLGNBQWM7Z0JBQUVaLEtBQUssRUFBRUEsS0FBSyxDQUFDWSxPQUFPO2FBQUUsQ0FBQyxDQUFDO1FBQzFFLENBQUM7SUFDSCxDQUFDO0FBQ0gsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL3NtbS1jb250ZW50LWNhbGVuZGFyLy4vcGFnZXMvYXBpL3VwbG9hZC5qcz81NTcyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEluY29taW5nRm9ybSB9IGZyb20gJ2Zvcm1pZGFibGUnO1xuaW1wb3J0IHsgcHJvbWlzZXMgYXMgZnMgfSBmcm9tICdmcyc7XG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcbmltcG9ydCB7IGdldFNlc3Npb24gfSBmcm9tICduZXh0LWF1dGgvcmVhY3QnO1xuXG5leHBvcnQgY29uc3QgY29uZmlnID0ge1xuICBhcGk6IHtcbiAgICBib2R5UGFyc2VyOiBmYWxzZSxcbiAgfSxcbn07XG5cbmNvbnN0IHVwbG9hZERpciA9IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCAncHVibGljL3VwbG9hZHMnKTtcblxuLy8gVGVzdCB1c2VyIElEIGZvciBtZW1vcnkgc3RvcmFnZVxuY29uc3QgVEVTVF9VU0VSX0lEID0gJ3Rlc3QtdXNlci0xMjMnO1xuXG4vLyBFbnN1cmUgdXBsb2FkIGRpcmVjdG9yeSBleGlzdHNcbmNvbnN0IGVuc3VyZURpciA9IGFzeW5jICgpID0+IHtcbiAgdHJ5IHtcbiAgICBhd2FpdCBmcy5hY2Nlc3ModXBsb2FkRGlyKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBhd2FpdCBmcy5ta2Rpcih1cGxvYWREaXIsIHsgcmVjdXJzaXZlOiB0cnVlIH0pO1xuICB9XG59O1xuXG4vLyDQpNGD0L3QutGG0LjRjyDQtNC70Y8g0L7Rh9C40YHRgtC60Lgg0LjQvNC10L3QuCDRhNCw0LnQu9CwINC+0YIg0L3QtdC00L7Qv9GD0YHRgtC40LzRi9GFINGB0LjQvNCy0L7Qu9C+0LJcbmNvbnN0IHNhbml0aXplRmlsZU5hbWUgPSAobmFtZSkgPT4ge1xuICByZXR1cm4gbmFtZS5yZXBsYWNlKC9bXmEtekEtWjAtOV8tXS9nLCAnXycpO1xufTtcblxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXEsIHJlcykge1xuICAvLyBDaGVjayBhdXRoZW50aWNhdGlvblxuICBjb25zdCBzZXNzaW9uID0gYXdhaXQgZ2V0U2Vzc2lvbih7IHJlcSB9KTtcbiAgaWYgKCFzZXNzaW9uKSB7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHsgbWVzc2FnZTogJ05vdCBhdXRoZW50aWNhdGVkJyB9KTtcbiAgfVxuXG4gIGlmIChyZXEubWV0aG9kICE9PSAnUE9TVCcpIHtcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDUpLmpzb24oeyBtZXNzYWdlOiAnTWV0aG9kIG5vdCBhbGxvd2VkJyB9KTtcbiAgfVxuXG4gIHRyeSB7XG4gICAgYXdhaXQgZW5zdXJlRGlyKCk7XG5cbiAgICBjb25zdCBmb3JtID0gbmV3IEluY29taW5nRm9ybSh7XG4gICAgICB1cGxvYWREaXIsXG4gICAgICBrZWVwRXh0ZW5zaW9uczogdHJ1ZSxcbiAgICAgIG1heEZpbGVTaXplOiAxMCAqIDEwMjQgKiAxMDI0LCAvLyAxME1CXG4gICAgICBtdWx0aXBsZXM6IHRydWUsIC8vINCg0LDQt9GA0LXRiNCw0LXQvCDQt9Cw0LPRgNGD0LfQutGDINC90LXRgdC60L7Qu9GM0LrQuNGFINGE0LDQudC70L7QslxuICAgIH0pO1xuXG4gICAgZm9ybS5wYXJzZShyZXEsIGFzeW5jIChlcnIsIGZpZWxkcywgZmlsZXMpID0+IHtcbiAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgbWVzc2FnZTogJ1VwbG9hZCBmYWlsZWQnLCBlcnJvcjogZXJyLm1lc3NhZ2UgfSk7XG4gICAgICB9XG5cbiAgICAgIC8vINCf0L7Qu9GD0YfQsNC10Lwg0L3QsNC30LLQsNC90LjQtSDQv9GA0L7QtdC60YLQsCDQuCDQtNCw0YLRgyDQuNC3INC/0L7Qu9C10Lkg0LfQsNC/0YDQvtGB0LBcbiAgICAgIGNvbnN0IHByb2plY3ROYW1lID0gZmllbGRzLnByb2plY3ROYW1lID8gc2FuaXRpemVGaWxlTmFtZShmaWVsZHMucHJvamVjdE5hbWVbMF0pIDogJ3VubmFtZWQnO1xuICAgICAgY29uc3QgZGF0ZSA9IGZpZWxkcy5kYXRlID8gc2FuaXRpemVGaWxlTmFtZShmaWVsZHMuZGF0ZVswXSkgOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXTtcbiAgICAgIGNvbnN0IGRheUluZGV4ID0gZmllbGRzLmRheUluZGV4ID8gcGFyc2VJbnQoZmllbGRzLmRheUluZGV4WzBdKSA6IDA7XG4gICAgICBcbiAgICAgIC8vINCe0LHRgNCw0LHQvtGC0LrQsCDQvtC00L3QvtCz0L4g0LjQu9C4INC90LXRgdC60L7Qu9GM0LrQuNGFINGE0LDQudC70L7QslxuICAgICAgY29uc3QgZmlsZUxpc3QgPSBmaWxlcy5maWxlO1xuICAgICAgXG4gICAgICAvLyDQldGB0LvQuCDRhNCw0LnQu9C+0LIg0L3QtdGCLCDQstC+0LfQstGA0LDRidCw0LXQvCDQvtGI0LjQsdC60YNcbiAgICAgIGlmICghZmlsZUxpc3QpIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgbWVzc2FnZTogJ05vIGZpbGVzIHVwbG9hZGVkJyB9KTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8g0J/RgNC10L7QsdGA0LDQt9GD0LXQvCDQsiDQvNCw0YHRgdC40LIsINC10YHQu9C4INGN0YLQviDQvtC00LjQvSDRhNCw0LnQu1xuICAgICAgY29uc3QgZmlsZXNBcnJheSA9IEFycmF5LmlzQXJyYXkoZmlsZUxpc3QpID8gZmlsZUxpc3QgOiBbZmlsZUxpc3RdO1xuICAgICAgXG4gICAgICBpZiAoZmlsZXNBcnJheS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgbWVzc2FnZTogJ05vIGZpbGVzIHVwbG9hZGVkJyB9KTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8g0J7QsdGA0LDQsdCw0YLRi9Cy0LDQtdC8INC60LDQttC00YvQuSDRhNCw0LnQu1xuICAgICAgY29uc3QgdXBsb2FkZWRGaWxlcyA9IGF3YWl0IFByb21pc2UuYWxsKGZpbGVzQXJyYXkubWFwKGFzeW5jIChmaWxlLCBpbmRleCkgPT4ge1xuICAgICAgICAvLyDQpNC+0YDQvNC40YDRg9C10Lwg0LjQvNGPINGE0LDQudC70LAg0L/QviDRgdGF0LXQvNC1OiDQvdCw0LfQstCw0L3QuNC1INC/0YDQvtC10LrRgtCwX9C00LDRgtCwX2ltZ1/Qv9C+0YDRj9C00LrQvtCy0YvQuSDQvdC+0LzQtdGAX9GD0L3QuNC60LDQu9GM0L3Ri9C5INC40LTQtdC90YLQuNGE0LjQutCw0YLQvtGAXG4gICAgICAgIGNvbnN0IG9yaWdpbmFsRmlsZW5hbWUgPSBmaWxlLm9yaWdpbmFsRmlsZW5hbWUgfHwgJ2ltYWdlLmpwZyc7XG4gICAgICAgIGNvbnN0IGV4dCA9IHBhdGguZXh0bmFtZShvcmlnaW5hbEZpbGVuYW1lKTtcbiAgICAgICAgY29uc3QgYmFzZUluZGV4ID0gZmllbGRzLmJhc2VJbmRleCA/IHBhcnNlSW50KGZpZWxkcy5iYXNlSW5kZXhbMF0pIDogMDtcbiAgICAgICAgY29uc3QgaW1hZ2VJbmRleCA9IGJhc2VJbmRleCArIGluZGV4O1xuICAgICAgICAvLyDQlNC+0LHQsNCy0LvRj9C10Lwg0YPQvdC40LrQsNC70YzQvdGL0Lkg0LjQtNC10L3RgtC40YTQuNC60LDRgtC+0YAgKNGC0LXQutGD0YnQtdC1INCy0YDQtdC80Y8g0LIg0LzQuNC70LvQuNGB0LXQutGD0L3QtNCw0YUgKyDRgdC70YPRh9Cw0LnQvdC+0LUg0YfQuNGB0LvQvilcbiAgICAgICAgY29uc3QgdW5pcXVlSWQgPSBgJHtEYXRlLm5vdygpfV8ke01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMDAwKX1gO1xuICAgICAgICBjb25zdCBmaWxlbmFtZSA9IGAke3Byb2plY3ROYW1lfV8ke2RhdGV9X2ltZ18ke2ltYWdlSW5kZXh9XyR7dW5pcXVlSWR9JHtleHR9YDtcbiAgICAgICAgXG4gICAgICAgIC8vIE1vdmUgZmlsZSB0byBmaW5hbCBkZXN0aW5hdGlvblxuICAgICAgICBjb25zdCBmaW5hbFBhdGggPSBwYXRoLmpvaW4odXBsb2FkRGlyLCBmaWxlbmFtZSk7XG4gICAgICAgIGF3YWl0IGZzLnJlbmFtZShmaWxlLmZpbGVwYXRoLCBmaW5hbFBhdGgpO1xuXG4gICAgICAgIC8vIFJldHVybiB0aGUgcGF0aCB0aGF0IGNhbiBiZSB1c2VkIHRvIGFjY2VzcyB0aGUgZmlsZVxuICAgICAgICByZXR1cm4gYC91cGxvYWRzLyR7ZmlsZW5hbWV9YDtcbiAgICAgIH0pKTtcblxuICAgICAgLy8gUmV0dXJuIHRoZSBwYXRocyB0aGF0IGNhbiBiZSB1c2VkIHRvIGFjY2VzcyB0aGUgZmlsZXNcbiAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgXG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsIFxuICAgICAgICB1cmxzOiB1cGxvYWRlZEZpbGVzIFxuICAgICAgfSk7XG4gICAgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignVXBsb2FkIGVycm9yOicsIGVycm9yKTtcbiAgICBcbiAgICAvLyBJZiB0aGVyZSdzIGFuIGVycm9yIHdpdGggZmlsZSBzeXN0ZW0gb3BlcmF0aW9ucywgcHJvdmlkZSBtb2NrIFVSTHMgZm9yIHRlc3QgdXNlclxuICAgIGlmIChzZXNzaW9uLnVzZXIuaWQgPT09IFRFU1RfVVNFUl9JRCkge1xuICAgICAgLy8gR2VuZXJhdGUgZmFrZSBpbWFnZSBVUkxzIGZvciB0aGUgdGVzdCB1c2VyXG4gICAgICBjb25zdCBwcm9qZWN0TmFtZSA9ICd0ZXN0X3Byb2plY3QnO1xuICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdO1xuICAgICAgY29uc3QgbW9ja0ltYWdlVXJscyA9IEFycmF5KDMpLmZpbGwoKS5tYXAoKF8sIGkpID0+IGAvbW9jay1pbWFnZS0ke3Byb2plY3ROYW1lfV8ke2RhdGV9X2ltZ18ke2l9LmpwZ2ApO1xuICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyBcbiAgICAgICAgc3VjY2VzczogdHJ1ZSwgXG4gICAgICAgIHVybHM6IG1vY2tJbWFnZVVybHNcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IG1lc3NhZ2U6ICdTZXJ2ZXIgZXJyb3InLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9KTtcbiAgICB9XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJJbmNvbWluZ0Zvcm0iLCJwcm9taXNlcyIsImZzIiwicGF0aCIsImdldFNlc3Npb24iLCJjb25maWciLCJhcGkiLCJib2R5UGFyc2VyIiwidXBsb2FkRGlyIiwiam9pbiIsInByb2Nlc3MiLCJjd2QiLCJURVNUX1VTRVJfSUQiLCJlbnN1cmVEaXIiLCJhY2Nlc3MiLCJlcnJvciIsIm1rZGlyIiwicmVjdXJzaXZlIiwic2FuaXRpemVGaWxlTmFtZSIsIm5hbWUiLCJyZXBsYWNlIiwiaGFuZGxlciIsInJlcSIsInJlcyIsInNlc3Npb24iLCJzdGF0dXMiLCJqc29uIiwibWVzc2FnZSIsIm1ldGhvZCIsImZvcm0iLCJrZWVwRXh0ZW5zaW9ucyIsIm1heEZpbGVTaXplIiwibXVsdGlwbGVzIiwicGFyc2UiLCJlcnIiLCJmaWVsZHMiLCJmaWxlcyIsInByb2plY3ROYW1lIiwiZGF0ZSIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsInNwbGl0IiwiZGF5SW5kZXgiLCJwYXJzZUludCIsImZpbGVMaXN0IiwiZmlsZSIsImZpbGVzQXJyYXkiLCJBcnJheSIsImlzQXJyYXkiLCJsZW5ndGgiLCJ1cGxvYWRlZEZpbGVzIiwiUHJvbWlzZSIsImFsbCIsIm1hcCIsImluZGV4Iiwib3JpZ2luYWxGaWxlbmFtZSIsImV4dCIsImV4dG5hbWUiLCJiYXNlSW5kZXgiLCJpbWFnZUluZGV4IiwidW5pcXVlSWQiLCJub3ciLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJmaWxlbmFtZSIsImZpbmFsUGF0aCIsInJlbmFtZSIsImZpbGVwYXRoIiwic3VjY2VzcyIsInVybHMiLCJjb25zb2xlIiwidXNlciIsImlkIiwibW9ja0ltYWdlVXJscyIsImZpbGwiLCJfIiwiaSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./pages/api/upload.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = (__webpack_exec__("(api)/./pages/api/upload.js"));
module.exports = __webpack_exports__;

})();